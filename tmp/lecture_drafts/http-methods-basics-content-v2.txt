# HTTP методы: основы

## Введение: как меню в ресторане 🍽️

Представьте ресторан: вы открываете меню и выбираете действие — посмотреть блюда, заказать, заменить гарнир или отменить заказ.  
HTTP‑методы — это такие же **глаголы действий** в общении клиента и сервера.

💡 **Совет:** метод отвечает на вопрос **«что мы делаем?»**, а URL — **«с чем?»**.  
✅ **Вывод:** метод = действие, ресурс = объект этого действия.

---

## Что такое HTTP

**HTTP (HyperText Transfer Protocol)** — это протокол общения клиента и сервера.  
Браузер отправляет запрос, сервер возвращает ответ. Всё происходит по правилам HTTP.

### Простая аналогия 📬
- Вы пишете письмо (запрос).
- Указываете, что хотите сделать (метод).
- Отправляете по адресу (URL).
- Получаете ответ от сервера.

✅ **Вывод:** HTTP — это «язык» запроса и ответа.

---

## Что такое REST API

**REST (Representational State Transfer)** — стиль построения API, где есть ресурсы и действия над ними.  
**Ресурс** — это сущность: пользователь, курс, заказ.

Пример ресурса:

~~~
/courses
/courses/42
/users/7
~~~

✅ **Вывод:** REST говорит, *какие ресурсы есть*, а HTTP‑методы — *что с ними делать*.

---

## HTTP методы — глаголы действий

Ниже — ключевые методы, которые используются каждый день.

---

## 1. `GET` — получить данные

**Назначение:** запросить ресурс без изменения данных.  
**Аналогия:** посмотреть меню, не делая заказ.

**Пример:**
~~~
GET /courses?level=beginner
~~~

**Характеристики:**
- ✅ Безопасный (не меняет данные).
- ✅ Идемпотентный (повтор даёт тот же результат).
- ✅ Кешируемый.

**Когда использовать:** чтение, поиск, фильтры.  
✅ **Вывод:** `GET` — это «покажи».

---

## 2. `POST` — создать

**Назначение:** создать новый ресурс.  
**Аналогия:** оформить заказ в ресторане.

**Пример:**
~~~
POST /users
~~~

**Характеристики:**
- ✅ Обычно не идемпотентный (повтор создаёт ещё один ресурс).
- ✅ Данные передаются в теле запроса.
- ✅ Не кешируется по умолчанию.

**Когда использовать:** регистрация, оформление заказа, отправка формы.  
✅ **Вывод:** `POST` — это «создай».

---

## 3. `PUT` — полная замена ресурса

**Назначение:** заменить ресурс целиком.  
**Аналогия:** переписать анкету заново.

**Пример:**
~~~
PUT /users/7
~~~

**Характеристики:**
- ✅ Идемпотентный (повтор даёт тот же результат).
- ✅ Требует полного представления ресурса.
- ✅ Может создать ресурс, если его не было (зависит от API).

**Когда использовать:** когда вы отправляете **всю** обновлённую сущность.  
✅ **Вывод:** `PUT` — это «замени полностью».

---

## 4. `PATCH` — частичное обновление

**Назначение:** изменить только часть данных.  
**Аналогия:** дописать одно поле в анкете.

**Пример:**
~~~
PATCH /users/7
~~~

**Характеристики:**
- ✅ Меняет только указанные поля.
- ✅ Идемпотентность не гарантируется (зависит от реализации).
- ✅ Экономит трафик по сравнению с `PUT`.

**Когда использовать:** когда обновляется 1–2 поля, а не весь объект.  
✅ **Вывод:** `PATCH` — это «исправь часть».

---

## 5. `DELETE` — удалить ресурс

**Назначение:** удалить ресурс.  
**Аналогия:** отменить заказ.

**Пример:**
~~~
DELETE /users/7
~~~

**Характеристики:**
- ✅ Идемпотентный (повтор всё равно оставит ресурс удалённым).
- ✅ Не безопасный (меняет состояние).

**Когда использовать:** удаление сущностей или логическое удаление.  
✅ **Вывод:** `DELETE` — это «удали».

---

## 6. `HEAD` — получить только заголовки

**Назначение:** проверить ресурс без загрузки тела.  
**Аналогия:** спросить «есть ли товар?» без покупки.

**Пример:**
~~~
HEAD /files/report.pdf
~~~

**Характеристики:**
- ✅ Возвращает только заголовки ответа.
- ✅ Используется для проверки существования или размера.

**Когда использовать:** быстрая проверка ресурса, кеш‑проверки.  
✅ **Вывод:** `HEAD` — это «проверь без содержимого».

---

## 7. `OPTIONS` — узнать, что разрешено

**Назначение:** узнать доступные методы для ресурса.  
**Аналогия:** спросить «что можно заказать?» перед заказом.

**Пример:**
~~~
OPTIONS /users
~~~

**Характеристики:**
- ✅ Сервер отвечает списком разрешённых методов.
- ✅ Используется в CORS (preflight‑запросы).

**Когда использовать:** когда нужно выяснить возможности API или пройти CORS‑проверку.  
✅ **Вывод:** `OPTIONS` — это «какие действия доступны?»

---

## 8. `TRACE` — диагностика пути запроса

**Назначение:** получить «эхо» запроса для диагностики.  
**Аналогия:** попросить повторить, что вы отправили.

**Пример:**
~~~
TRACE /debug
~~~

**Характеристики:**
- ✅ Редко используется.
- ✅ Часто отключён из соображений безопасности.

**Когда использовать:** почти никогда в продакшене.  
✅ **Вывод:** `TRACE` — диагностический метод.

---

## Идемпотентность методов

**Идемпотентность** означает: повторный запрос даёт тот же результат.

### Идемпотентные ✅
- `GET`, `HEAD`, `PUT`, `DELETE`, `OPTIONS`

### Не гарантируют идемпотентность ❌
- `POST`
- `PATCH` (зависит от реализации)

✅ **Вывод:** идемпотентность важна для безопасных повторов запросов.

---

## Безопасные (Safe) методы

**Безопасные** методы не изменяют данные.

### Безопасные ✅
- `GET`, `HEAD`, `OPTIONS`

### Не безопасные ❌
- `POST`, `PUT`, `PATCH`, `DELETE`

✅ **Вывод:** безопасные методы можно вызывать без риска изменить состояние.

---

## Кешируемые методы

Обычно кешируются:
- `GET`
- `HEAD`

**Важно:** кеширование зависит от заголовков ответа.  
✅ **Вывод:** кеш нужен, чтобы не гонять одинаковые данные каждый раз.

---

## Сводная таблица HTTP методов

| Метод   | Смысл действия              | Идемпотентный | Безопасный | Типичный сценарий |
|---------|-----------------------------|---------------|------------|-------------------|
| GET     | Получить данные             | Да            | Да         | Поиск, список     |
| POST    | Создать ресурс              | Нет           | Нет        | Регистрация       |
| PUT     | Полная замена               | Да            | Нет        | Обновить всё      |
| PATCH   | Частичное обновление        | Не всегда     | Нет        | Изменить поле     |
| DELETE  | Удалить ресурс              | Да            | Нет        | Удалить сущность  |
| HEAD    | Заголовки без тела          | Да            | Да         | Проверка ресурса  |
| OPTIONS | Разрешённые методы          | Да            | Да         | CORS/preflight    |
| TRACE   | Диагностика                 | Да            | Да         | Отладка           |

---

## Практические примеры

### Пример 1: Работа с пользователями

~~~
GET /users              — получить список
POST /users             — создать пользователя
GET /users/7            — получить пользователя
PUT /users/7            — заменить пользователя
PATCH /users/7          — обновить часть данных
DELETE /users/7         — удалить пользователя
HEAD /users/7           — проверить наличие
OPTIONS /users          — узнать доступные методы
~~~

✅ **Вывод:** один ресурс, разные действия — разные методы.

---

### Пример 2: Когда использовать PUT vs PATCH

- **PUT** — если вы отправляете *всю сущность целиком*.
- **PATCH** — если меняете *1–2 поля*.

✅ **Вывод:** PUT = полная замена, PATCH = частичное обновление.

---

## Частые ошибки и как их избежать

### ❌ Ошибка 1: Использовать `GET` для изменения данных
✅ **Правильно:** изменения — это `POST`, `PUT`, `PATCH`, `DELETE`.

### ❌ Ошибка 2: Обновлять ресурс через `POST`
✅ **Правильно:** обновление = `PUT` или `PATCH`.

### ❌ Ошибка 3: Делать частичный `PUT`
✅ **Правильно:** если обновляете часть — используйте `PATCH`.

### ❌ Ошибка 4: Пытаться обновить без ID ресурса
✅ **Правильно:** для изменения нужен конкретный ресурс: `/users/7`.

### ❌ Ошибка 5: Игнорировать идемпотентность
✅ **Правильно:** учитывайте, что повторный `POST` создаст ещё один ресурс.

---

## Заключение

### Ключевые мысли
🎯 HTTP‑метод отвечает на вопрос «что сделать?».  
🎯 `GET` — читать, `POST` — создавать, `PUT` — заменять, `PATCH` — править, `DELETE` — удалять.  
🎯 Идемпотентность и безопасность помогают понимать поведение запросов.

Понимайте смысл методов — и API станет логичным и предсказуемым.
