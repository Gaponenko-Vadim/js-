import { PrismaClient } from '@prisma/client';
import { PrismaPg } from '@prisma/adapter-pg';
import { Pool } from 'pg';
import dotenv from 'dotenv';
import path from 'path';

const envPath = path.resolve(__dirname, '..', '.env');
dotenv.config({ path: envPath });

const pool = new Pool({ connectionString: process.env.DATABASE_URL });
const adapter = new PrismaPg(pool);
const prisma = new PrismaClient({ adapter });

const lectureContent = `# HTML: списки и таблицы

## Что такое списки и таблицы?

**Списки** упорядочивают однотипные элементы, а **таблицы** показывают данные в виде сетки.  
Список — как чек‑лист, таблица — как таблица в Excel.

💡 Совет: сначала спросите себя «это перечень или сравнение?» — так проще выбрать разметку.  
✅ Вывод: список = порядок и структура, таблица = сравнение по столбцам и строкам.

---

## 1. Списки — структурируем однотипные элементы 🧾

**Назначение:** собрать элементы в понятный перечень.  
**Аналогия:** список покупок в телефоне.

**Пример:**
~~~html
<ul>
  <li>HTML</li>
  <li>CSS</li>
  <li>JavaScript</li>
</ul>
~~~

**Характеристики:**
- ✅ Каждый пункт находится внутри **li**.
- ✅ Контейнер списка — **ul** или **ol**.
- ✅ Можно вкладывать списки друг в друга.

**Когда использовать:** когда есть перечень однотипных элементов.

✅ Вывод: список — это смысловая структура, а не способ сделать отступы.

---

## 2. Маркированный список (ul) — без порядка

**Назначение:** перечислить элементы без важного порядка.  
**Аналогия:** набор ингредиентов.

**Пример:**
~~~html
<ul>
  <li>Доступ к курсам</li>
  <li>Проверка знаний</li>
  <li>Домашние задания</li>
</ul>
~~~

**Когда использовать:** когда важен перечень, но порядок не имеет значения.

✅ Вывод: ul = набор пунктов, где порядок не важен.

---

## 3. Нумерованный список (ol) — порядок важен

**Назначение:** показать шаги или последовательность.  
**Аналогия:** рецепт приготовления блюда.

**Пример:**
~~~html
<ol>
  <li>Выберите курс</li>
  <li>Оформите подписку</li>
  <li>Начните обучение</li>
</ol>
~~~

**Когда использовать:** для инструкций, этапов, процессов.

✅ Вывод: ol = порядок и логика шагов.

---

## 4. Список определений (dl) — термин и описание

**Назначение:** дать объяснение терминам.  
**Аналогия:** словарь.

**Пример:**
~~~html
<dl>
  <dt>Курс</dt>
  <dd>Набор уроков по теме.</dd>
</dl>
~~~

**Когда использовать:** для терминов, статусов, параметров.

✅ Вывод: dl полезен, когда нужно связать понятие и его смысл.

---

## 5. Вложенные списки

**Назначение:** показать структуру «уровень → подуровни».  
**Аналогия:** оглавление книги.

**Пример:**
~~~html
<ul>
  <li>Модуль 1
    <ul>
      <li>Урок 1</li>
      <li>Урок 2</li>
    </ul>
  </li>
</ul>
~~~

✅ Вывод: вложенные списки показывают иерархию.

---

## 6. Таблица — данные в сетке 📊

**Назначение:** сравнить элементы по общим параметрам.  
**Аналогия:** таблица тарифов в прайс‑листе.

**Пример:**
~~~html
<table>
  <caption>Тарифы</caption>
  <tr>
    <th>План</th>
    <th>Цена</th>
  </tr>
  <tr>
    <td>Базовый</td>
    <td>500 ₽</td>
  </tr>
</table>
~~~

**Характеристики:**
- ✅ **table** — контейнер таблицы.
- ✅ **tr** — строка, **td** — ячейка, **th** — заголовок.
- ✅ **caption** объясняет, что именно сравнивается.

**Когда использовать:** когда нужна сетка и сравнение по параметрам.

✅ Вывод: таблица — это данные, а не способ сделать сетку из блоков.

---

## 7. Структура таблицы: thead / tbody / tfoot

**Назначение:** разделить заголовок, тело и итог.  
**Аналогия:** как шапка, основная часть и итог в документе.

**Пример:**
~~~html
<table>
  <caption>Сравнение тарифов</caption>
  <thead>
    <tr>
      <th>План</th>
      <th>Цена</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Базовый</td>
      <td>500 ₽</td>
    </tr>
  </tbody>
  <tfoot>
    <tr>
      <td>Итого</td>
      <td>1 500 ₽</td>
    </tr>
  </tfoot>
</table>
~~~

✅ Вывод: thead/tbody/tfoot упрощают чтение таблицы и улучшают доступность.

---

## 8. Заголовки и доступность таблицы

**Назначение:** объяснить, как читать строки и столбцы.  
**Пример:**
~~~html
<th scope="col">План</th>
<th scope="row">Базовый</th>
~~~

**Почему это важно:** scope говорит скринридеру, что это заголовок строки или столбца.

✅ Вывод: th + scope делает таблицу понятной для всех.

---

## 9. Объединение ячеек (rowspan / colspan)

**Назначение:** объединить одинаковые значения.  
**Пример:**
~~~html
<td colspan="2">Итого: 1 500 ₽</td>
~~~

💡 Совет: используйте объединение только когда это действительно упрощает чтение.
✅ Вывод: colspan и rowspan — для логики таблицы, а не для дизайна.

---

## 10. Список или таблица?

| Ситуация | Правильный выбор |
| --- | --- |
| Перечень функций | Список (ul/ol) |
| Инструкция по шагам | Список (ol) |
| Сравнение тарифов | Таблица |
| Термины и определения | Список (dl) |

✅ Вывод: если нужно сравнение — таблица, если перечень — список.

---

## Best Practices

- Каждый пункт списка всегда внутри **li**.
- ul — для перечней, ol — для шагов.
- dl — для терминов и определений.
- Таблица только для данных и сравнения.
- Всегда добавляйте **caption** и заголовки **th**.
- Для доступности указывайте **scope**.

✅ Вывод: правильная разметка списков и таблиц делает данные понятными и читаемыми.

---

## Заключение

Списки и таблицы — это язык структуры.  
Если вы правильно выбираете формат, страница становится понятной без лишнего дизайна.

### Ключевые мысли

🎯 Списки отвечают за структуру перечней  
🎯 Таблицы нужны для сравнения данных  
🎯 Семантика делает контент доступным

💪 Практикуйтесь — хорошая структура всегда выглядит сильнее.
`;

const scenariosContent = `## Популярные сценарии

### Типичные ошибки (сводка)

- Список используется ради отступов, а не смысла.  
- Пункты списка вне li — ломается структура.  
- ol используется там, где нет порядка.  
- Таблица используется для верстки страницы.  
- В таблице нет th и caption — теряется смысл.  
- Нет thead/tbody — сложнее читать и поддерживать.  
- Отсутствует scope у заголовков таблицы.  

---

### Сценарий 1: Список без li

❌ **Неправильно**: пункты списка лежат напрямую в ul.  
✅ **Правильно**: каждый пункт внутри li.

**До:**
~~~html
<ul>
  Пункт 1
  Пункт 2
</ul>
~~~

**После:**
~~~html
<ul>
  <li>Пункт 1</li>
  <li>Пункт 2</li>
</ul>
~~~

**Почему**: li — обязательный контейнер для пункта списка.

**Практический пример:**  
DOC-01: Все пункты перечней оформляются через li.

---

### Сценарий 2: Порядок не важен, но стоит ol

❌ **Неправильно**: список с номерами там, где порядок не нужен.  
✅ **Правильно**: используйте ul.

**До:**
~~~html
<ol>
  <li>HTML</li>
  <li>CSS</li>
</ol>
~~~

**После:**
~~~html
<ul>
  <li>HTML</li>
  <li>CSS</li>
</ul>
~~~

**Почему**: ol задаёт порядок, а здесь это не важно.

**Практический пример:**  
REQ-02: Для перечня технологий используйте ul.

---

### Сценарий 3: Список ради отступов

❌ **Неправильно**: список используется только для визуального отступа.  
✅ **Правильно**: обычный текст — в абзацах.

**До:**
~~~html
<ul>
  <li>Описание курса</li>
</ul>
~~~

**После:**
~~~html
<p>Описание курса</p>
~~~

**Почему**: список должен отражать структуру, а не стиль.

**Практический пример:**  
DOC-03: Текстовые блоки оформляются абзацами, не списками.

---

### Сценарий 4: Таблица для макета

❌ **Неправильно**: таблица используется для раскладки блоков.  
✅ **Правильно**: таблица только для данных.

**До:**
~~~html
<table>
  <tr><td>Блок</td><td>Блок</td></tr>
</table>
~~~

**После:**
~~~html
<div class="grid">
  <div>Блок</div>
  <div>Блок</div>
</div>
~~~

**Почему**: таблица должна хранить данные, а не строить сетку.

**Практический пример:**  
REQ-04: Для сетки каталога используйте CSS, не таблицы.

---

### Сценарий 5: Таблица без заголовков

❌ **Неправильно**: в таблице нет th и caption.  
✅ **Правильно**: добавить заголовки и подпись.

**До:**
~~~html
<table>
  <tr><td>Базовый</td><td>500 ₽</td></tr>
</table>
~~~

**После:**
~~~html
<table>
  <caption>Тарифы</caption>
  <tr>
    <th>План</th>
    <th>Цена</th>
  </tr>
  <tr>
    <td>Базовый</td>
    <td>500 ₽</td>
  </tr>
</table>
~~~

**Почему**: caption объясняет таблицу, th задаёт смысл столбцов.

**Практический пример:**  
DOC-05: Таблицы тарифов обязательно имеют caption и th.

---

### Сценарий 6: Заголовки без scope

❌ **Неправильно**: th без указания области.  
✅ **Правильно**: добавить scope.

**До:**
~~~html
<th>План</th>
~~~

**После:**
~~~html
<th scope="col">План</th>
~~~

**Почему**: scope говорит скринридеру, что это заголовок строки или столбца.

**Практический пример:**  
REQ-06: В таблицах заголовки колонок имеют scope="col".

---

### Сценарий 7: Вложенный список вне li

❌ **Неправильно**: вложенный список не внутри пункта.  
✅ **Правильно**: вложение делается внутри li.

**До:**
~~~html
<ul>
  <li>Модуль 1</li>
  <ul>
    <li>Урок 1</li>
  </ul>
</ul>
~~~

**После:**
~~~html
<ul>
  <li>Модуль 1
    <ul>
      <li>Урок 1</li>
    </ul>
  </li>
</ul>
~~~

**Почему**: вложенный список относится к конкретному пункту.

**Практический пример:**  
DOC-07: Подуровни структуры размещаются внутри li.

---

### Сценарий 8: Объединение без смысла

❌ **Неправильно**: colspan для красоты, а не для логики.  
✅ **Правильно**: объединять только если это смысловой итог.

**До:**
~~~html
<td colspan="2">Скидка</td>
~~~

**После:**
~~~html
<td colspan="2">Итого: 1 500 ₽</td>
~~~

**Почему**: объединение должно упрощать чтение, а не усложнять.

**Практический пример:**  
REQ-08: colspan используется только в строках итогов.

---

### Сценарий 9: Термины оформлены как обычный список

❌ **Неправильно**: термины и определения записаны через ul/li.  
✅ **Правильно**: использовать dl/dt/dd.

**До:**
~~~html
<ul>
  <li>Гарантия — срок бесплатного обслуживания</li>
  <li>Рассрочка — покупка частями</li>
</ul>
~~~

**После:**
~~~html
<dl>
  <dt>Гарантия</dt>
  <dd>Срок бесплатного обслуживания</dd>
  <dt>Рассрочка</dt>
  <dd>Покупка частями</dd>
</dl>
~~~

**Почему**: dl отражает связь «термин → объяснение», список её теряет.

**Практический пример:**  
DOC-09: Термины оформляются через dl/dt/dd.

---

### Сценарий 10: Таблица без структуры

❌ **Неправильно**: в таблице нет thead/tbody.  
✅ **Правильно**: отделить заголовок от данных.

**До:**
~~~html
<table>
  <tr><th>Модель</th><th>Цена</th></tr>
  <tr><td>iPhone 15</td><td>109 990 ₽</td></tr>
</table>
~~~

**После:**
~~~html
<table>
  <thead>
    <tr><th>Модель</th><th>Цена</th></tr>
  </thead>
  <tbody>
    <tr><td>iPhone 15</td><td>109 990 ₽</td></tr>
  </tbody>
</table>
~~~

**Почему**: thead/tbody упрощают чтение, стилизацию и доступность.

**Практический пример:**  
REQ-10: Таблицы имеют thead и tbody.

---

### Сценарий 11: Шаги через переносы строк

❌ **Неправильно**: шаги оформлены обычным текстом с <br>.  
✅ **Правильно**: использовать ol/li.

**До:**
~~~html
<p>
  Выбрать модель<br>
  Оставить заявку<br>
  Получить доставку
</p>
~~~

**После:**
~~~html
<ol>
  <li>Выбрать модель</li>
  <li>Оставить заявку</li>
  <li>Получить доставку</li>
</ol>
~~~

**Почему**: ol показывает порядок шагов, а <br> — просто переносы.

**Практический пример:**  
DOC-11: Все инструкции по шагам оформляются через ol.
`;

const tasksContent = `## Подготовка к заданиям

🎯 **Цель:** собрать один цельный мини‑проект и по шагам улучшать его с помощью списков и таблиц.  
📱 **Контекст:** делаем страницу магазина смартфонов «SmartLine».  
🧩 **Как работать:** вставьте каркас в любой редактор и выполняйте задания по порядку — каждое задание дополняет проект.

Каркас (правильный HTML):

~~~html
<!doctype html>
<html lang="ru">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>SmartLine — магазин смартфонов</title>
  </head>
  <body style="margin: 0; font-family: Arial, sans-serif; background: #f3f4f6;">
    <div style="padding: 24px;">
      <div style="max-width: 960px; margin: 0 auto; background: #ffffff; border-radius: 16px; padding: 24px; box-shadow: 0 12px 30px rgba(0,0,0,0.08);">
        <header style="margin-bottom: 24px;">
          <h1 style="margin: 0 0 6px;">SmartLine — магазин смартфонов</h1>
          <p style="margin: 0; color: #555;">Подбирайте модели, сравнивайте цены и оформляйте заказ онлайн.</p>
        </header>

        <main style="display: block;">
          <section style="margin: 24px 0; padding: 16px; border: 1px solid #ddd; border-radius: 12px;" aria-labelledby="benefits-title">
            <h2 id="benefits-title" style="margin: 0 0 12px;">Почему выбирают SmartLine</h2>
            <!-- TODO: список преимуществ -->
          </section>

          <section style="margin: 24px 0; padding: 16px; border: 1px solid #ddd; border-radius: 12px;" aria-labelledby="steps-title">
            <h2 id="steps-title" style="margin: 0 0 12px;">Как оформить заказ</h2>
            <!-- TODO: шаги заказа -->
          </section>

          <section style="margin: 24px 0; padding: 16px; border: 1px solid #ddd; border-radius: 12px;">
            <h2 style="margin: 0 0 12px;">Словарь покупателя</h2>
            <!-- TODO: dl/dt/dd -->
          </section>

          <section style="margin: 24px 0; padding: 16px; border: 1px solid #ddd; border-radius: 12px;">
            <h2 style="margin: 0 0 12px;">Каталог и линейки</h2>
            <!-- TODO: вложенный список брендов -->
          </section>

          <section style="margin: 24px 0; padding: 16px; border: 1px solid #ddd; border-radius: 12px;">
            <h2 style="margin: 0 0 12px;">Сравнение моделей</h2>
            <!-- TODO: таблица моделей -->
          </section>
        </main>

        <footer style="margin-top: 24px; color: #777; font-size: 13px;">
          © 2026 SmartLine. Все цены указаны в рублях.
        </footer>
      </div>
    </div>
  </body>
</html>
~~~

## Задания для практики 🧪

### Задание 1: Преимущества магазина
**Кратко:**  
Ситуация: есть три преимущества магазина.  
Что сделать: оформить их списком.  
Критерий: видно, что это перечень без порядка.  

**Описание:**  
🔎 **Ситуация:** блок «Почему выбирают SmartLine» выглядит как набор абзацев.  
✅ **Что сделать:** оформить преимущества через список ul/li.  
📌 **Требования:**  
- сохранить заголовок и aria-labelledby;  
- пункты короткие и по делу;  
- три преимущества.  
🎯 **Критерий:** понятно, что это список, а не просто текст.  

🧱 **Исходник (как сейчас):**
~~~html
<section style="margin: 24px 0; padding: 16px; border: 1px solid #ddd; border-radius: 12px;" aria-labelledby="benefits-title">
  <h2 id="benefits-title" style="margin: 0 0 12px;">Почему выбирают SmartLine</h2>
  <p>Гарантия 2 года</p>
  <p>Доставка в день заказа</p>
  <p>Честные цены без скрытых доплат</p>
</section>
~~~

**Ответ:**
**Было:**
~~~html
<section style="margin: 24px 0; padding: 16px; border: 1px solid #ddd; border-radius: 12px;" aria-labelledby="benefits-title">
  <h2 id="benefits-title" style="margin: 0 0 12px;">Почему выбирают SmartLine</h2>
  <p>Гарантия 2 года</p>
  <p>Доставка в день заказа</p>
  <p>Честные цены без скрытых доплат</p>
</section>
~~~

**Стало:**
~~~html
<section style="margin: 24px 0; padding: 16px; border: 1px solid #ddd; border-radius: 12px;" aria-labelledby="benefits-title">
  <h2 id="benefits-title" style="margin: 0 0 12px;">Почему выбирают SmartLine</h2>
  <ul>
    <li>Гарантия 2 года</li>
    <li>Доставка в день заказа</li>
    <li>Честные цены без скрытых доплат</li>
  </ul>
</section>
~~~
**Объяснение:** ul показывает перечень пунктов без строгого порядка.  
Так преимущества воспринимаются быстрее и визуально отделяются от остального текста.  
Структура остаётся доступной и понятной.

---

### Задание 2: Шаги оформления заказа
**Кратко:**  
Ситуация: нужно показать последовательность действий.  
Что сделать: оформить шаги упорядоченным списком.  
Критерий: порядок виден сразу.  

**Описание:**  
🔎 **Ситуация:** блок «Как оформить заказ» пока выглядит как обычные строки.  
✅ **Что сделать:** превратить их в ol/li, чтобы порядок читался без CSS.  
📌 **Требования:**  
- сохранить заголовок и aria-labelledby;  
- три шага в правильном порядке.  
🎯 **Критерий:** понятно, что это пошаговая инструкция.  

🧱 **Исходник (как сейчас):**
~~~html
<section style="margin: 24px 0; padding: 16px; border: 1px solid #ddd; border-radius: 12px;" aria-labelledby="steps-title">
  <h2 id="steps-title" style="margin: 0 0 12px;">Как оформить заказ</h2>
  <p>Выбрать модель</p>
  <p>Оставить заявку</p>
  <p>Получить доставку</p>
</section>
~~~

**Ответ:**
**Было:**
~~~html
<section style="margin: 24px 0; padding: 16px; border: 1px solid #ddd; border-radius: 12px;" aria-labelledby="steps-title">
  <h2 id="steps-title" style="margin: 0 0 12px;">Как оформить заказ</h2>
  <p>Выбрать модель</p>
  <p>Оставить заявку</p>
  <p>Получить доставку</p>
</section>
~~~

**Стало:**
~~~html
<section style="margin: 24px 0; padding: 16px; border: 1px solid #ddd; border-radius: 12px;" aria-labelledby="steps-title">
  <h2 id="steps-title" style="margin: 0 0 12px;">Как оформить заказ</h2>
  <ol>
    <li>Выбрать модель</li>
    <li>Оставить заявку</li>
    <li>Получить доставку</li>
  </ol>
</section>
~~~
**Объяснение:** ol показывает порядок шагов, а li выделяет каждый шаг отдельно.  
Пользователь сразу понимает последовательность действий.  
Так инструкции читаются быстрее.

---

### Задание 3: Словарь покупателя
**Кратко:**  
Ситуация: есть термины с пояснениями.  
Что сделать: оформить их как список определений.  
Критерий: видна связь «термин → объяснение».  

**Описание:**  
🔎 **Ситуация:** термины в словаре сейчас написаны как абзацы.  
✅ **Что сделать:** оформить их через dl/dt/dd.  
📌 **Требования:**  
- термин — dt;  
- объяснение — dd;  
- два термина минимум.  
🎯 **Критерий:** структура словаря читается даже без стилей.  

🧱 **Исходник (как сейчас):**
~~~html
<section style="margin: 24px 0; padding: 16px; border: 1px solid #ddd; border-radius: 12px;">
  <h2 style="margin: 0 0 12px;">Словарь покупателя</h2>
  <p><strong>Гарантия</strong> — срок бесплатного обслуживания.</p>
  <p><strong>Рассрочка</strong> — покупка с оплатой частями.</p>
</section>
~~~

**Ответ:**
**Было:**
~~~html
<section style="margin: 24px 0; padding: 16px; border: 1px solid #ddd; border-radius: 12px;">
  <h2 style="margin: 0 0 12px;">Словарь покупателя</h2>
  <p><strong>Гарантия</strong> — срок бесплатного обслуживания.</p>
  <p><strong>Рассрочка</strong> — покупка с оплатой частями.</p>
</section>
~~~

**Стало:**
~~~html
<section style="margin: 24px 0; padding: 16px; border: 1px solid #ddd; border-radius: 12px;">
  <h2 style="margin: 0 0 12px;">Словарь покупателя</h2>
  <dl>
    <dt>Гарантия</dt>
    <dd>Срок бесплатного обслуживания.</dd>
    <dt>Рассрочка</dt>
    <dd>Покупка с оплатой частями.</dd>
  </dl>
</section>
~~~
**Объяснение:** dl создан для пар «термин → значение».  
Dt показывает термин, dd — его объяснение.  
Так словарь читается структурированно.

---

### Задание 4: Каталог и линейки
**Кратко:**  
Ситуация: есть бренды и их линейки.  
Что сделать: показать иерархию вложенным списком.  
Критерий: линейки вложены в бренд.  

**Описание:**  
🔎 **Ситуация:** список брендов и моделей сейчас плоский, связи нет.  
✅ **Что сделать:** вложить список линеек внутрь пункта бренда.  
📌 **Требования:**  
- внешний список — ul;  
- вложенный список внутри нужного li.  
🎯 **Критерий:** видно, какие модели относятся к бренду.  

🧱 **Исходник (как сейчас):**
~~~html
<section style="margin: 24px 0; padding: 16px; border: 1px solid #ddd; border-radius: 12px;">
  <h2 style="margin: 0 0 12px;">Каталог и линейки</h2>
  <ul>
    <li>Apple</li>
    <li>iPhone 15</li>
    <li>iPhone 15 Pro</li>
    <li>Samsung</li>
    <li>Galaxy S24</li>
    <li>Galaxy A55</li>
  </ul>
</section>
~~~

**Ответ:**
**Было:**
~~~html
<section style="margin: 24px 0; padding: 16px; border: 1px solid #ddd; border-radius: 12px;">
  <h2 style="margin: 0 0 12px;">Каталог и линейки</h2>
  <ul>
    <li>Apple</li>
    <li>iPhone 15</li>
    <li>iPhone 15 Pro</li>
    <li>Samsung</li>
    <li>Galaxy S24</li>
    <li>Galaxy A55</li>
  </ul>
</section>
~~~

**Стало:**
~~~html
<section style="margin: 24px 0; padding: 16px; border: 1px solid #ddd; border-radius: 12px;">
  <h2 style="margin: 0 0 12px;">Каталог и линейки</h2>
  <ul>
    <li>Apple
      <ul>
        <li>iPhone 15</li>
        <li>iPhone 15 Pro</li>
      </ul>
    </li>
    <li>Samsung
      <ul>
        <li>Galaxy S24</li>
        <li>Galaxy A55</li>
      </ul>
    </li>
  </ul>
</section>
~~~
**Объяснение:** вложенный список показывает связь «бренд → линейки».  
Структура становится понятной и расширяемой.  
Так легче добавлять новые бренды и модели.

---

### Задание 5: Таблица моделей
**Кратко:**  
Ситуация: нужно сравнить модели и цены.  
Что сделать: оформить таблицу с подписью.  
Критерий: есть caption и заголовки столбцов.  

**Описание:**  
🔎 **Ситуация:** в блоке «Сравнение моделей» данные написаны строками.  
✅ **Что сделать:** сделать таблицу сравнения.  
📌 **Требования:**  
- использовать table;  
- добавить caption;  
- заголовки столбцов оформить через th.  
🎯 **Критерий:** таблица читается с первого взгляда.  

🧱 **Исходник (как сейчас):**
~~~html
<section style="margin: 24px 0; padding: 16px; border: 1px solid #ddd; border-radius: 12px;">
  <h2 style="margin: 0 0 12px;">Сравнение моделей</h2>
  <p>iPhone 15 — 109 990 ₽</p>
  <p>Galaxy S24 — 89 990 ₽</p>
</section>
~~~

**Ответ:**
**Было:**
~~~html
<section style="margin: 24px 0; padding: 16px; border: 1px solid #ddd; border-radius: 12px;">
  <h2 style="margin: 0 0 12px;">Сравнение моделей</h2>
  <p>iPhone 15 — 109 990 ₽</p>
  <p>Galaxy S24 — 89 990 ₽</p>
</section>
~~~

**Стало:**
~~~html
<section style="margin: 24px 0; padding: 16px; border: 1px solid #ddd; border-radius: 12px;">
  <h2 style="margin: 0 0 12px;">Сравнение моделей</h2>
  <table>
    <caption>Популярные смартфоны</caption>
    <tr>
      <th>Модель</th>
      <th>Цена</th>
    </tr>
    <tr>
      <td>iPhone 15</td>
      <td>109 990 ₽</td>
    </tr>
    <tr>
      <td>Galaxy S24</td>
      <td>89 990 ₽</td>
    </tr>
  </table>
</section>
~~~
**Объяснение:** caption объясняет тему таблицы, а th задаёт заголовки столбцов.  
Так сравнение читается по вертикали.  
Пользователь быстрее выбирает модель.

---

### Задание 6: Структура таблицы
**Кратко:**  
Ситуация: таблица есть, но шапка и данные не отделены.  
Что сделать: добавить thead и tbody.  
Критерий: заголовки находятся в thead.  

**Описание:**  
🔎 **Ситуация:** продолжаем таблицу сравнения из задания 5.  
✅ **Что сделать:** вынести заголовки в thead, строки данных — в tbody.  
📌 **Требования:**  
- thead содержит th;  
- tbody содержит td;  
- порядок строк сохраняется.  
🎯 **Критерий:** видно разделение «шапка / данные».  

🧱 **Исходник (как сейчас):**
~~~html
<table>
  <caption>Популярные смартфоны</caption>
  <tr>
    <th>Модель</th>
    <th>Цена</th>
  </tr>
  <tr>
    <td>iPhone 15</td>
    <td>109 990 ₽</td>
  </tr>
  <tr>
    <td>Galaxy S24</td>
    <td>89 990 ₽</td>
  </tr>
</table>
~~~

**Ответ:**
**Было:**
~~~html
<table>
  <caption>Популярные смартфоны</caption>
  <tr>
    <th>Модель</th>
    <th>Цена</th>
  </tr>
  <tr>
    <td>iPhone 15</td>
    <td>109 990 ₽</td>
  </tr>
  <tr>
    <td>Galaxy S24</td>
    <td>89 990 ₽</td>
  </tr>
</table>
~~~

**Стало:**
~~~html
<table>
  <caption>Популярные смартфоны</caption>
  <thead>
    <tr>
      <th>Модель</th>
      <th>Цена</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>iPhone 15</td>
      <td>109 990 ₽</td>
    </tr>
    <tr>
      <td>Galaxy S24</td>
      <td>89 990 ₽</td>
    </tr>
  </tbody>
</table>
~~~
**Объяснение:** thead и tbody отделяют заголовки от данных.  
Это полезно для стилей и сортировки таблиц.  
Структура становится понятнее.

---

### Задание 7: Доступность заголовков
**Кратко:**  
Ситуация: нужно уточнить, что заголовки относятся к столбцам.  
Что сделать: добавить scope.  
Критерий: у th есть scope="col".  

**Описание:**  
🔎 **Ситуация:** заголовки есть, но связь со столбцами не указана.  
✅ **Что сделать:** добавить scope="col" для заголовков.  
📌 **Требования:**  
- не менять текст заголовков;  
- добавить scope="col" для каждого th.  
🎯 **Критерий:** скринридер корректно читает таблицу.  

🧱 **Исходник (как сейчас):**
~~~html
<th>Модель</th>
<th>Цена</th>
~~~

**Ответ:**
**Было:**
~~~html
<th>Модель</th>
<th>Цена</th>
~~~

**Стало:**
~~~html
<th scope="col">Модель</th>
<th scope="col">Цена</th>
~~~
**Объяснение:** scope="col" говорит, что это заголовок столбца.  
Так скринридер связывает каждую ячейку с правильным заголовком.  
Таблица читается корректно.

---

### Задание 8: Итоговая строка
**Кратко:**  
Ситуация: нужно показать итог одной строкой.  
Что сделать: объединить ячейки.  
Критерий: используется colspan.  

**Описание:**  
🔎 **Ситуация:** в конце таблицы хотим показать итог, но строка разбита на две ячейки.  
✅ **Что сделать:** объединить ячейки через colspan.  
📌 **Требования:**  
- использовать colspan="2";  
- итоговая строка в одной ячейке.  
🎯 **Критерий:** итог читается как отдельная строка.  

🧱 **Исходник (как сейчас):**
~~~html
<tr>
  <td>Итого</td>
  <td>2 модели</td>
</tr>
~~~

**Ответ:**
**Было:**
~~~html
<tr>
  <td>Итого</td>
  <td>2 модели</td>
</tr>
~~~

**Стало:**
~~~html
<tr>
  <td colspan="2">Итого: 2 модели в сравнении</td>
</tr>
~~~
**Объяснение:** colspan объединяет ячейки, поэтому итог выглядит как отдельная строка.  
Так результат не теряется среди данных.  
Пользователь сразу видит итог.
`;
const exampleContent = `## Пример: списки и таблицы в каталоге 📄

Разрабатывается условно такой сайт: платформа онлайн‑курсов.  
После всех митингов с бизнесом и постановки задачи нужно было решить проблему:  
пользователи терялись в каталоге и не понимали, где они находятся.

Ниже — фрагмент готового документа по спискам и таблицам.

---

### Раздел: Каталог курсов — структура и сравнение

**Цель:** пользователь быстро видит структуру курса и сравнивает тарифы.

**Требования:**
1) Программа курса показывается списком модулей и уроков.  
2) Для перечня функций используется ul, для шагов — ol.  
3) Термины в справке оформляются через dl (термин → определение).  
4) Сравнение тарифов делается таблицей с caption, thead и tbody.  
5) Заголовки таблицы имеют th и scope.  

**Критерии приёмки:**
- Структура курса понятна без дополнительных подсказок.  
- Таблица тарифов читается с первого взгляда.  
- Заголовки и подпись таблицы присутствуют.  

**Фрагмент реализации (пример кода):**
~~~html
<h2>Программа курса</h2>
<ul>
  <li>Модуль 1
    <ul>
      <li>Урок 1: Введение</li>
      <li>Урок 2: Практика</li>
    </ul>
  </li>
</ul>

<h2>Тарифы</h2>
<table>
  <caption>Сравнение тарифов</caption>
  <thead>
    <tr>
      <th scope="col">План</th>
      <th scope="col">Цена</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Базовый</td>
      <td>500 ₽</td>
    </tr>
  </tbody>
</table>
~~~
`;

async function createHtmlListsTablesLecture() {
  try {
    const lectureTitle = 'HTML: списки и таблицы';
    const legacyTitle = 'HTML: СЃРїРёСЃРєРё Рё С‚Р°Р±Р»РёС†С‹';
    console.log(`🔄 Обновление лекции "${lectureTitle}"...\n`);

    const existingLectures = await prisma.lecture.findMany({
      where: { title: { in: [lectureTitle, legacyTitle] } },
      orderBy: { createdAt: 'asc' }
    });

    let lecture;
    if (existingLectures.length > 0) {
      const [primary, ...duplicates] = existingLectures;
      lecture = await prisma.lecture.update({
        where: { id: primary.id },
        data: {
          title: lectureTitle,
          topic: 'HTML',
          content: lectureContent,
          scenariosContent,
          exampleContent,
          tasksContent
        }
      });

      if (duplicates.length > 0) {
        await prisma.lecture.deleteMany({
          where: { id: { in: duplicates.map((item) => item.id) } }
        });
      }
    } else {
      lecture = await prisma.lecture.create({
        data: {
          title: lectureTitle,
          topic: 'HTML',
          content: lectureContent,
          scenariosContent,
          exampleContent,
          tasksContent
        }
      });
    }

    const test = await prisma.test.findFirst({
      where: { title: { in: [lectureTitle, legacyTitle] } },
      include: { questions: true }
    });

    if (test) {
      for (const tq of test.questions) {
        await prisma.question.update({
          where: { id: tq.questionId },
          data: { lectureId: lecture.id }
        });
      }
      console.log(`✅ Привязано вопросов: ${test.questions.length}`);
    } else {
      console.log('⚠️ Тест не найден, вопросы не привязаны');
    }

    console.log(`✅ Лекция готова с ID: ${lecture.id}`);
  } catch (error) {
    console.error('❌ Ошибка:', error);
    throw error;
  } finally {
    await prisma.$disconnect();
    await pool.end();
  }
}

createHtmlListsTablesLecture();

