import { PrismaClient } from '@prisma/client';
import { PrismaPg } from '@prisma/adapter-pg';
import { Pool } from 'pg';
import dotenv from 'dotenv';

dotenv.config();

const pool = new Pool({ connectionString: process.env.DATABASE_URL });
const adapter = new PrismaPg(pool);
const prisma = new PrismaClient({ adapter });

const lectureContent = `# HTTP –°—Ç–∞—Ç—É—Å –∫–æ–¥—ã: –û—à–∏–±–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞ (5xx)

## –í–≤–µ–¥–µ–Ω–∏–µ: –ß—Ç–æ —Ç–∞–∫–æ–µ –æ—à–∏–±–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞?

–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ, —á—Ç–æ –≤—ã –ø—Ä–∏—à–ª–∏ –≤ —Ä–µ—Å—Ç–æ—Ä–∞–Ω –∏ —Å–¥–µ–ª–∞–ª–∏ –∑–∞–∫–∞–∑. –í—ã –≤—Å—ë —Å–¥–µ–ª–∞–ª–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ: –≤—ã–±—Ä–∞–ª–∏ –±–ª—é–¥–æ –∏–∑ –º–µ–Ω—é, –≤–µ–∂–ª–∏–≤–æ –ø–æ–ø—Ä–æ—Å–∏–ª–∏ –æ—Ñ–∏—Ü–∏–∞–Ω—Ç–∞, —É–∫–∞–∑–∞–ª–∏ –≤—Å–µ –¥–µ—Ç–∞–ª–∏. –ù–æ –≤–¥—Ä—É–≥:
- **–°–ª–æ–º–∞–ª–∞—Å—å –∫—É—Ö–Ω—è** ‚Üí —à–µ—Ñ-–ø–æ–≤–∞—Ä: "–ù–µ –º–æ–≥—É –ø—Ä–∏–≥–æ—Ç–æ–≤–∏—Ç—å" (500)
- **–ö–æ–Ω—á–∏–ª–∏—Å—å –ø—Ä–æ–¥—É–∫—Ç—ã** ‚Üí "–†–µ—Å—Ç–æ—Ä–∞–Ω –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç" (503)
- **–ü–æ—Å—Ç–∞–≤—â–∏–∫ –Ω–µ –ø—Ä–∏–≤—ë–∑ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã** ‚Üí "–ü—Ä–æ–±–ª–µ–º–∞ —Å –ø–æ—Å—Ç–∞–≤–∫–æ–π" (502)
- **–°–ª–∏—à–∫–æ–º –¥–æ–ª–≥–æ –≥–æ—Ç–æ–≤—è—Ç** ‚Üí "–ö—É—Ö–Ω—è –Ω–µ –æ—Ç–≤–µ—Ç–∏–ª–∞ –≤–æ–≤—Ä–µ–º—è" (504)

**HTTP —Å—Ç–∞—Ç—É—Å –∫–æ–¥—ã 5xx** ‚Äî —ç—Ç–æ —Å–ø–æ—Å–æ–± —Å–µ—Ä–≤–µ—Ä–∞ —Å–∫–∞–∑–∞—Ç—å:
> "–ü—Ä–æ–±–ª–µ–º–∞ –Ω–∞ **–º–æ–µ–π** —Å—Ç–æ—Ä–æ–Ω–µ. –í–∞—à –∑–∞–ø—Ä–æ—Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π, –Ω–æ **—è** –Ω–µ —Å–º–æ–≥ –µ–≥–æ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å."

---

## –î–∏–∞–ø–∞–∑–æ–Ω 5xx: –û—à–∏–±–∫–∏ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ —Å–µ—Ä–≤–µ—Ä–∞

### –û–±—â–∞—è —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞

–ö–æ–¥—ã **5xx (500-599)** –æ–∑–Ω–∞—á–∞—é—Ç, —á—Ç–æ:
- ‚ùå **–°–µ—Ä–≤–µ—Ä** –Ω–µ —Å–º–æ–≥ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∑–∞–ø—Ä–æ—Å
- ‚úÖ **–ö–ª–∏–µ–Ω—Ç** —Å–¥–µ–ª–∞–ª –≤—Å—ë –ø—Ä–∞–≤–∏–ª—å–Ω–æ (–ø—Ä–æ–±–ª–µ–º–∞ –ù–ï –≤ –∑–∞–ø—Ä–æ—Å–µ)
- üîÑ –ö–ª–∏–µ–Ω—Ç **–º–æ–∂–µ—Ç –ø–æ–≤—Ç–æ—Ä–∏—Ç—å** –∑–∞–ø—Ä–æ—Å –ø–æ–∑–∂–µ
- üìù –°–µ—Ä–≤–µ—Ä **–û–ë–Ø–ó–ê–ù** –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–∏ –æ—à–∏–±–∫–∏

### –ö—Ç–æ –≤–∏–Ω–æ–≤–∞—Ç?

| –î–∏–∞–ø–∞–∑–æ–Ω | –í–∏–Ω–æ–≤–Ω–∏–∫ | –ß—Ç–æ –¥–µ–ª–∞—Ç—å –∫–ª–∏–µ–Ω—Ç—É |
|----------|----------|-------------------|
| **4xx** | **–ö–ª–∏–µ–Ω—Ç** | –ò—Å–ø—Ä–∞–≤–∏—Ç—å –∑–∞–ø—Ä–æ—Å |
| **5xx** | **–°–µ—Ä–≤–µ—Ä** | –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –ø–æ–∑–∂–µ –∏–ª–∏ –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É |

### –ö–ª—é—á–µ–≤–æ–µ –æ—Ç–ª–∏—á–∏–µ –æ—Ç 4xx

**4xx**: "–í—ã —Å–¥–µ–ª–∞–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ç–∞–∫" ‚Üí –∫–ª–∏–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω –∏—Å–ø—Ä–∞–≤–∏—Ç—å –∑–∞–ø—Ä–æ—Å
**5xx**: "–Ø (—Å–µ—Ä–≤–µ—Ä) –Ω–µ —Å–º–æ–≥ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å" ‚Üí –∫–ª–∏–µ–Ω—Ç –º–æ–∂–µ—Ç –ø–æ–≤—Ç–æ—Ä–∏—Ç—å —Ç–æ—Ç –∂–µ –∑–∞–ø—Ä–æ—Å –ø–æ–∑–∂–µ

---

## 500 Internal Server Error ‚Äî –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

### –û–ø–∏—Å–∞–Ω–∏–µ

**500 Internal Server Error** ‚Äî —Å–∞–º—ã–π –æ–±—â–∏–π –∫–æ–¥ —Å–µ—Ä–≤–µ—Ä–Ω–æ–π –æ—à–∏–±–∫–∏.

> "–ß—Ç–æ-—Ç–æ **—Å–ª–æ–º–∞–ª–æ—Å—å** –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ, –Ω–æ —è –Ω–µ –º–æ–≥—É —Ç–æ—á–Ω–æ —Å–∫–∞–∑–∞—Ç—å —á—Ç–æ."

### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

- ‚úÖ –ù–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –≤ –∫–æ–¥–µ
- ‚úÖ –û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Å—Ö–µ–º—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (–≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –ª–æ–≥–∏–∫–∞)
- ‚úÖ –û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –ë–î (connection failed, query error)
- ‚úÖ –õ—é–±–∞—è –Ω–µ–ø—Ä–µ–¥–≤–∏–¥–µ–Ω–Ω–∞—è —Å–µ—Ä–≤–µ—Ä–Ω–∞—è –æ—à–∏–±–∫–∞

### –ß—Ç–æ –ù–ï –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 500

‚ùå **–ù–ï –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ 500 –¥–ª—è**:
- –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫ ‚Üí –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ **4xx** (–Ω–∞–ø—Ä–∏–º–µ—Ä, 400, 409, 422)
- –í–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞ ‚Üí –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ **422** –∏–ª–∏ **400**
- –†–µ—Å—É—Ä—Å –Ω–µ –Ω–∞–π–¥–µ–Ω ‚Üí –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ **404**

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: –ß—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –∫–ª–∏–µ–Ω—Ç—É?

**–í production**:

‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ**:
\`\`\`json
{
  "error": "Internal Server Error",
  "message": "An unexpected error occurred",
  "requestId": "req-abc123"
}
\`\`\`

‚ùå **–ù–ò–ö–û–ì–î–ê –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–π—Ç–µ**:
- Stack traces (—Ä–∞—Å–∫—Ä—ã–≤–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–æ–¥–∞)
- SQL –∑–∞–ø—Ä–æ—Å—ã (SQL injection —Ä–∏—Å–∫–∏)
- –ü—É—Ç–∏ –∫ —Ñ–∞–π–ª–∞–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
- –î–µ—Ç–∞–ª–∏ –ë–î –æ—à–∏–±–æ–∫

### –ü—Ä–∏–º–µ—Ä—ã

**–û—à–∏–±–∫–∞ –ë–î**:

\`\`\`http
GET /api/users
\`\`\`

**–û—Ç–≤–µ—Ç** (–ë–î —É–ø–∞–ª–∞):
\`\`\`http
HTTP/1.1 500 Internal Server Error
Content-Type: application/json

{
  "error": "Internal Server Error",
  "message": "An unexpected error occurred. Please try again later.",
  "requestId": "req-abc123",
  "timestamp": "2024-01-15T10:30:00Z"
}
\`\`\`

**–õ–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞** (–Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –∫–ª–∏–µ–Ω—Ç—É!):
\`\`\`
[ERROR] Database connection failed: Connection timeout
  at DatabaseConnection.connect (db.js:45)
  at UserService.getUsers (users.js:12)
  Request ID: req-abc123
  Stack trace: ...
\`\`\`

**–ù–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ**:

\`\`\`http
POST /api/orders
Content-Type: application/json

{
  "items": [{"productId": 123, "quantity": 2}]
}
\`\`\`

**–û—Ç–≤–µ—Ç** (–µ—Å–ª–∏ –∫–æ–¥ —É–ø–∞–ª —Å –æ—à–∏–±–∫–æ–π):
\`\`\`http
HTTP/1.1 500 Internal Server Error
Content-Type: application/json

{
  "error": "Internal Server Error",
  "message": "Unable to process your request",
  "requestId": "req-def456"
}
\`\`\`

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

**–í–°–ï–ì–î–ê** –ª–æ–≥–∏—Ä—É–π—Ç–µ 500 –æ—à–∏–±–∫–∏ —Å –ø–æ–ª–Ω—ã–º–∏ –¥–µ—Ç–∞–ª—è–º–∏:

\`\`\`javascript
logger.error({
  requestId: 'req-abc123',
  error: error.message,
  stack: error.stack,
  url: req.url,
  method: req.method,
  body: req.body,
  userId: req.user?.id,
  timestamp: new Date().toISOString()
});
\`\`\`

---

## 501 Not Implemented ‚Äî –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### –û–ø–∏—Å–∞–Ω–∏–µ

**501 Not Implemented** –æ–∑–Ω–∞—á–∞–µ—Ç:

> "–°–µ—Ä–≤–µ—Ä **–Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç** —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å, –Ω–µ–æ–±—Ö–æ–¥–∏–º—É—é –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —ç—Ç–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞."

### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

- ‚úÖ HTTP –º–µ—Ç–æ–¥ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è —Å–µ—Ä–≤–µ—Ä–æ–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, TRACE, CONNECT)
- ‚úÖ –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å **–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ** (–Ω–æ –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å 405 –∏–ª–∏ 404)
- ‚úÖ –°–µ—Ä–≤–µ—Ä –Ω–µ –ø–æ–Ω–∏–º–∞–µ—Ç HTTP –º–µ—Ç–æ–¥

### 501 vs 405

| –ö–æ–¥ | –ó–Ω–∞—á–µ–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
|-----|----------|--------|
| **501** | –°–µ—Ä–≤–µ—Ä **–≤–æ–æ–±—â–µ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç** —ç—Ç–æ—Ç –º–µ—Ç–æ–¥ | TRACE –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ |
| **405** | –ú–µ—Ç–æ–¥ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –Ω–æ **–Ω–µ —Ä–∞–∑—Ä–µ—à—ë–Ω –¥–ª—è —ç—Ç–æ–≥–æ endpoint'–∞** | POST —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –Ω–æ –Ω–µ –Ω–∞ /users/123 |

### –ü—Ä–∏–º–µ—Ä—ã

**–ù–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π HTTP –º–µ—Ç–æ–¥**:

\`\`\`http
TRACE /api/users
\`\`\`

**–û—Ç–≤–µ—Ç**:
\`\`\`http
HTTP/1.1 501 Not Implemented
Content-Type: application/json

{
  "error": "Not Implemented",
  "message": "TRACE method is not supported by this server"
}
\`\`\`

**–§—É–Ω–∫—Ü–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ** (–Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è, –ª—É—á—à–µ 404):

\`\`\`http
GET /api/v2/analytics
\`\`\`

**–û—Ç–≤–µ—Ç**:
\`\`\`http
HTTP/1.1 501 Not Implemented
Content-Type: application/json

{
  "error": "Not Implemented",
  "message": "Analytics API v2 is under development"
}
\`\`\`

---

## 502 Bad Gateway ‚Äî –û—à–∏–±–∫–∞ —à–ª—é–∑–∞

### –û–ø–∏—Å–∞–Ω–∏–µ

**502 Bad Gateway** –æ–∑–Ω–∞—á–∞–µ—Ç:

> "–Ø (–ø—Ä–æ–∫—Å–∏/—à–ª—é–∑) –ø–æ–ª—É—á–∏–ª **–Ω–µ–≤–µ—Ä–Ω—ã–π –æ—Ç–≤–µ—Ç** –æ—Ç upstream —Å–µ—Ä–≤–µ—Ä–∞."

### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è

- ‚úÖ Reverse proxy –ø–æ–ª—É—á–∏–ª –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π –æ—Ç–≤–µ—Ç –æ—Ç –±—ç–∫–µ–Ω–¥–∞
- ‚úÖ API Gateway –Ω–µ —Å–º–æ–≥ —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å –æ—Ç–≤–µ—Ç –æ—Ç –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞
- ‚úÖ Load balancer –ø–æ–ª—É—á–∏–ª corrupted –¥–∞–Ω–Ω—ã–µ

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

\`\`\`
–ö–ª–∏–µ–Ω—Ç ‚Üí Nginx (proxy) ‚Üí Backend Server
                ‚Üì
            502 Bad Gateway
         (Backend –≤–µ—Ä–Ω—É–ª –º—É—Å–æ—Ä)
\`\`\`

### –ü—Ä–∏–º–µ—Ä—ã

**Backend –≤–µ—Ä–Ω—É–ª –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π HTTP**:

\`\`\`http
GET /api/users
\`\`\`

**–û—Ç–≤–µ—Ç –æ—Ç Nginx**:
\`\`\`http
HTTP/1.1 502 Bad Gateway
Content-Type: application/json

{
  "error": "Bad Gateway",
  "message": "Upstream server returned an invalid response"
}
\`\`\`

**–ü—Ä–∏—á–∏–Ω—ã**:
- Backend –≤–µ—Ä–Ω—É–ª –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–µ HTTP –∑–∞–≥–æ–ª–æ–≤–∫–∏
- Backend –≤–µ—Ä–Ω—É–ª –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç
- Backend —É–ø–∞–ª –≤–æ –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞

**API Gateway –Ω–µ —Å–º–æ–≥ —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å**:

\`\`\`http
GET /api/products
\`\`\`

**–û—Ç–≤–µ—Ç**:
\`\`\`http
HTTP/1.1 502 Bad Gateway
Content-Type: application/json

{
  "error": "Bad Gateway",
  "message": "Unable to process upstream response"
}
\`\`\`

---

## 503 Service Unavailable ‚Äî –°–µ—Ä–≤–∏—Å –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω

### –û–ø–∏—Å–∞–Ω–∏–µ

**503 Service Unavailable** –æ–∑–Ω–∞—á–∞–µ—Ç:

> "–°–µ—Ä–≤–µ—Ä **–≤—Ä–µ–º–µ–Ω–Ω–æ** –Ω–µ –º–æ–∂–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –∑–∞–ø—Ä–æ—Å (–æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ –∏–ª–∏ –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∞)."

### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

- ‚úÖ –ü–ª–∞–Ω–æ–≤–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ (maintenance)
- ‚úÖ –°–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–≥—Ä—É–∂–µ–Ω
- ‚úÖ –í—Ä–µ–º–µ–Ω–Ω–∞—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –ë–î
- ‚úÖ –î–µ–ø–ª–æ–π –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–∏

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫: Retry-After

**Retry-After** —É–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–æ–≥–¥–∞ –∫–ª–∏–µ–Ω—Ç –º–æ–∂–µ—Ç –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –∑–∞–ø—Ä–æ—Å.

**–§–æ—Ä–º–∞—Ç 1**: –°–µ–∫—É–Ω–¥—ã
\`\`\`http
Retry-After: 120
\`\`\`

**–§–æ—Ä–º–∞—Ç 2**: –î–∞—Ç–∞
\`\`\`http
Retry-After: Wed, 15 Jan 2024 12:00:00 GMT
\`\`\`

### –ü—Ä–∏–º–µ—Ä—ã

**–ü–ª–∞–Ω–æ–≤–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ**:

\`\`\`http
GET /api/users
\`\`\`

**–û—Ç–≤–µ—Ç**:
\`\`\`http
HTTP/1.1 503 Service Unavailable
Retry-After: 3600
Content-Type: application/json

{
  "error": "Service Unavailable",
  "message": "System is under maintenance",
  "estimatedDowntime": "1 hour",
  "retryAfter": 3600
}
\`\`\`

**–°–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–≥—Ä—É–∂–µ–Ω**:

\`\`\`http
POST /api/heavy-operation
\`\`\`

**–û—Ç–≤–µ—Ç**:
\`\`\`http
HTTP/1.1 503 Service Unavailable
Retry-After: 60
Content-Type: application/json

{
  "error": "Service Unavailable",
  "message": "Server is temporarily overloaded. Please try again.",
  "retryAfter": 60
}
\`\`\`

**–ë–î –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞**:

\`\`\`http
GET /api/products
\`\`\`

**–û—Ç–≤–µ—Ç**:
\`\`\`http
HTTP/1.1 503 Service Unavailable
Retry-After: 30
Content-Type: application/json

{
  "error": "Service Unavailable",
  "message": "Database is temporarily unavailable",
  "requestId": "req-xyz789"
}
\`\`\`

---

## 504 Gateway Timeout ‚Äî –¢–∞–π–º–∞—É—Ç —à–ª—é–∑–∞

### –û–ø–∏—Å–∞–Ω–∏–µ

**504 Gateway Timeout** –æ–∑–Ω–∞—á–∞–µ—Ç:

> "–Ø (–ø—Ä–æ–∫—Å–∏/—à–ª—é–∑) **–Ω–µ –ø–æ–ª—É—á–∏–ª –æ—Ç–≤–µ—Ç** –æ—Ç upstream —Å–µ—Ä–≤–µ—Ä–∞ –≤–æ–≤—Ä–µ–º—è."

### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è

- ‚úÖ Backend –Ω–µ –æ—Ç–≤–µ—Ç–∏–ª –∑–∞ –æ—Ç–≤–µ–¥—ë–Ω–Ω–æ–µ –≤—Ä–µ–º—è
- ‚úÖ –¢–∞–π–º–∞—É—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–º
- ‚úÖ –î–æ–ª–≥–∏–π –∑–∞–ø—Ä–æ—Å –∫ –ë–î (–ø—Ä–µ–≤—ã—Å–∏–ª –ª–∏–º–∏—Ç)

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

\`\`\`
–ö–ª–∏–µ–Ω—Ç ‚Üí Nginx (60s timeout) ‚Üí Backend (–æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç 90s)
                ‚Üì
            504 Gateway Timeout
         (Backend –Ω–µ –æ—Ç–≤–µ—Ç–∏–ª –∑–∞ 60s)
\`\`\`

### 502 vs 504

| –ö–æ–¥ | –ü—Ä–æ–±–ª–µ–º–∞ | –ü—Ä–∏–º–µ—Ä |
|-----|----------|--------|
| **502** | –ü–æ–ª—É—á–∏–ª **–Ω–µ–≤–µ—Ä–Ω—ã–π** –æ—Ç–≤–µ—Ç | Backend –≤–µ—Ä–Ω—É–ª –º—É—Å–æ—Ä |
| **504** | **–ù–µ –ø–æ–ª—É—á–∏–ª** –æ—Ç–≤–µ—Ç –≤–æ–≤—Ä–µ–º—è | Backend –¥–æ–ª–≥–æ –¥—É–º–∞–µ—Ç |

### –ü—Ä–∏–º–µ—Ä—ã

**Backend –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç**:

\`\`\`http
GET /api/reports/generate
\`\`\`

**–û—Ç–≤–µ—Ç –æ—Ç proxy** (—á–µ—Ä–µ–∑ 60 —Å–µ–∫—É–Ω–¥):
\`\`\`http
HTTP/1.1 504 Gateway Timeout
Content-Type: application/json

{
  "error": "Gateway Timeout",
  "message": "Upstream server did not respond in time",
  "timeout": 60
}
\`\`\`

**–î–æ–ª–≥–∏–π –∑–∞–ø—Ä–æ—Å –∫ –ë–î**:

\`\`\`http
POST /api/analytics/complex-query
\`\`\`

**–û—Ç–≤–µ—Ç**:
\`\`\`http
HTTP/1.1 504 Gateway Timeout
Content-Type: application/json

{
  "error": "Gateway Timeout",
  "message": "Request processing took too long",
  "suggestion": "Try reducing the date range or use async processing"
}
\`\`\`

---

## 502 vs 503 vs 504 ‚Äî –ö–ª—é—á–µ–≤—ã–µ —Ä–∞–∑–ª–∏—á–∏—è

| –ö–æ–¥ | –ü—Ä–æ–±–ª–µ–º–∞ | –ü—Ä–∏—á–∏–Ω–∞ | –†–µ—à–µ–Ω–∏–µ |
|-----|----------|---------|---------|
| **502** | –ù–µ–≤–µ—Ä–Ω—ã–π –æ—Ç–≤–µ—Ç | Backend –≤–µ—Ä–Ω—É–ª corrupted –¥–∞–Ω–Ω—ã–µ | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å backend –∫–æ–¥ |
| **503** | –í—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω | –û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ, –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∞ | –ü–æ–¥–æ–∂–¥–∞—Ç—å Retry-After |
| **504** | –¢–∞–π–º–∞—É—Ç | Backend —Å–ª–∏—à–∫–æ–º –¥–æ–ª–≥–æ –æ—Ç–≤–µ—á–∞–µ—Ç | –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å |

### –ê–Ω–∞–ª–æ–≥–∏—è —Å —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–º

**502 Bad Gateway**:
> –û—Ñ–∏—Ü–∏–∞–Ω—Ç –ø—Ä–∏–Ω—ë—Å –±–ª—é–¥–æ, –Ω–æ –æ–Ω–æ **–Ω–µ—Å—ä–µ–¥–æ–±–Ω–æ–µ** (–∫—É—Ö–Ω—è –ø—Ä–∏–≥–æ—Ç–æ–≤–∏–ª–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ)

**503 Service Unavailable**:
> –†–µ—Å—Ç–æ—Ä–∞–Ω **–∑–∞–∫—Ä—ã—Ç –Ω–∞ –æ–±–µ–¥** (–≤—Ä–µ–º–µ–Ω–Ω–æ)

**504 Gateway Timeout**:
> –û—Ñ–∏—Ü–∏–∞–Ω—Ç –∂–¥–∞–ª –±–ª—é–¥–æ **—Å–ª–∏—à–∫–æ–º –¥–æ–ª–≥–æ** (–∫—É—Ö–Ω—è –Ω–µ —É—Å–ø–µ–ª–∞)

---

## 505 HTTP Version Not Supported ‚Äî –í–µ—Ä—Å–∏—è HTTP –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è

### –û–ø–∏—Å–∞–Ω–∏–µ

**505 HTTP Version Not Supported** –æ–∑–Ω–∞—á–∞–µ—Ç:

> "–°–µ—Ä–≤–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç **–≤–µ—Ä—Å–∏—é HTTP –ø—Ä–æ—Ç–æ–∫–æ–ª–∞**, —É–∫–∞–∑–∞–Ω–Ω—É—é –≤ –∑–∞–ø—Ä–æ—Å–µ."

### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è

- ‚úÖ –ö–ª–∏–µ–Ω—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç HTTP/2, —Å–µ—Ä–≤–µ—Ä –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ HTTP/1.1
- ‚úÖ –°—Ç–∞—Ä—ã–π —Å–µ—Ä–≤–µ—Ä, –Ω–æ–≤—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª

### –ü—Ä–∏–º–µ—Ä

**–ó–∞–ø—Ä–æ—Å —Å HTTP/2**:

\`\`\`http
GET /api/users HTTP/2.0
\`\`\`

**–û—Ç–≤–µ—Ç** (—Å–µ—Ä–≤–µ—Ä –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ HTTP/1.1):
\`\`\`http
HTTP/1.1 505 HTTP Version Not Supported
Content-Type: application/json

{
  "error": "HTTP Version Not Supported",
  "message": "Server only supports HTTP/1.0 and HTTP/1.1",
  "requestedVersion": "HTTP/2.0",
  "supportedVersions": ["HTTP/1.0", "HTTP/1.1"]
}
\`\`\`

---

## 507 Insufficient Storage ‚Äî –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–µ—Å—Ç–∞

### –û–ø–∏—Å–∞–Ω–∏–µ

**507 Insufficient Storage** –æ–∑–Ω–∞—á–∞–µ—Ç:

> "–°–µ—Ä–≤–µ—Ä **–Ω–µ –º–æ–∂–µ—Ç** —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ—Å—É—Ä—Å –∏–∑-–∑–∞ **–Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∞ –º–µ—Å—Ç–∞** –Ω–∞ –¥–∏—Å–∫–µ."

### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

- ‚úÖ –î–∏—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω
- ‚úÖ –ö–≤–æ—Ç–∞ –ë–î –∏—Å—á–µ—Ä–ø–∞–Ω–∞
- ‚úÖ –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–µ—Å—Ç–∞ –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤

### –ü—Ä–∏–º–µ—Ä—ã

**–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞**:

\`\`\`http
POST /api/upload
Content-Type: multipart/form-data

[—Ñ–∞–π–ª 100 MB]
\`\`\`

**–û—Ç–≤–µ—Ç** (–¥–∏—Å–∫ –∑–∞–ø–æ–ª–Ω–µ–Ω):
\`\`\`http
HTTP/1.1 507 Insufficient Storage
Content-Type: application/json

{
  "error": "Insufficient Storage",
  "message": "Server is out of disk space",
  "suggestion": "Please contact support"
}
\`\`\`

**–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –≤ –ë–î**:

\`\`\`http
POST /api/documents
Content-Type: application/json

{
  "title": "Large document",
  "content": "[very large text...]"
}
\`\`\`

**–û—Ç–≤–µ—Ç** (–∫–≤–æ—Ç–∞ –ë–î –∏—Å—á–µ—Ä–ø–∞–Ω–∞):
\`\`\`http
HTTP/1.1 507 Insufficient Storage
Content-Type: application/json

{
  "error": "Insufficient Storage",
  "message": "Database storage limit reached"
}
\`\`\`

---

## 511 Network Authentication Required ‚Äî –¢—Ä–µ–±—É–µ—Ç—Å—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –≤ —Å–µ—Ç–∏

### –û–ø–∏—Å–∞–Ω–∏–µ

**511 Network Authentication Required** –æ–∑–Ω–∞—á–∞–µ—Ç:

> "–¢—Ä–µ–±—É–µ—Ç—Å—è **–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –≤ —Å–µ—Ç–∏** (captive portal) –ø–µ—Ä–µ–¥ –¥–æ—Å—Ç—É–ø–æ–º –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É."

### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è

- ‚úÖ Wi-Fi –≤ –æ—Ç–µ–ª–µ, –∞—ç—Ä–æ–ø–æ—Ä—Ç—É (–Ω—É–∂–Ω–æ –≤–≤–µ—Å—Ç–∏ –ø–∞—Ä–æ–ª—å)
- ‚úÖ –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–∞—è —Å–µ—Ç—å —Å captive portal
- ‚úÖ –ü—É–±–ª–∏—á–Ω—ã–π Wi-Fi —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π

### –ü—Ä–∏–º–µ—Ä

**–ó–∞–ø—Ä–æ—Å –∏–∑ –ø—É–±–ª–∏—á–Ω–æ–π Wi-Fi —Å–µ—Ç–∏**:

\`\`\`http
GET /api/users
\`\`\`

**–û—Ç–≤–µ—Ç –æ—Ç —Å–µ—Ç–µ–≤–æ–≥–æ —à–ª—é–∑–∞**:
\`\`\`http
HTTP/1.1 511 Network Authentication Required
Content-Type: text/html

<html>
<head><title>Wi-Fi Login Required</title></head>
<body>
  <h1>Please log in to use Wi-Fi</h1>
  <form action="/login" method="POST">
    <input name="username" />
    <input name="password" type="password" />
    <button>Login</button>
  </form>
</body>
</html>
\`\`\`

> üí° **–í–∞–∂–Ω–æ**: –≠—Ç–æ –∫–æ–¥ –¥–ª—è **—Å–µ—Ç–µ–≤—ã—Ö** —à–ª—é–∑–æ–≤, –∞ –Ω–µ –¥–ª—è API –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ 401 –¥–ª—è API).

---

## –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ 5xx –æ—à–∏–±–æ–∫

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å!

**–í–°–ï–ì–î–ê** –ª–æ–≥–∏—Ä—É–π—Ç–µ –≤—Å–µ 5xx –æ—à–∏–±–∫–∏ —Å –ø–æ–ª–Ω—ã–º–∏ –¥–µ—Ç–∞–ª—è–º–∏:

‚úÖ **–ß—Ç–æ –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å**:
- –ü–æ–ª–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—à–∏–±–∫–∏
- Stack trace
- Request ID (–¥–ª—è —Ç—Ä–µ–π—Å–∏–Ω–≥–∞)
- URL, HTTP –º–µ—Ç–æ–¥
- –¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ (–æ—Å—Ç–æ—Ä–æ–∂–Ω–æ —Å —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏!)
- User ID (–µ—Å–ª–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω)
- IP –∞–¥—Ä–µ—Å –∫–ª–∏–µ–Ω—Ç–∞
- Timestamp
- Server hostname/instance ID

### –ü—Ä–∏–º–µ—Ä –ª–æ–≥–∞

\`\`\`json
{
  "level": "ERROR",
  "timestamp": "2024-01-15T10:30:45.123Z",
  "requestId": "req-abc123",
  "statusCode": 500,
  "error": {
    "message": "Cannot read property 'id' of undefined",
    "stack": "TypeError: Cannot read property 'id' of undefined\\n    at UserService.getUser (users.js:45)\\n    ..."
  },
  "request": {
    "method": "GET",
    "url": "/api/users/123",
    "headers": {
      "user-agent": "Mozilla/5.0...",
      "authorization": "[REDACTED]"
    }
  },
  "user": {
    "id": "user-456",
    "role": "admin"
  },
  "server": {
    "hostname": "api-server-01",
    "instanceId": "i-0abc123def"
  }
}
\`\`\`

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–ù–∞—Å—Ç—Ä–æ–π—Ç–µ **–∞–ª–µ—Ä—Ç—ã** –Ω–∞ 5xx –æ—à–∏–±–∫–∏:
- üìä –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ 5xx –∑–∞ –ø–µ—Ä–∏–æ–¥ –ø—Ä–µ–≤—ã—Å–∏–ª–æ –ø–æ—Ä–æ–≥
- üìà –†–æ—Å—Ç 5xx –æ—à–∏–±–æ–∫ (spike detection)
- üö® –ö—Ä–∏—Ç–∏—á–Ω—ã–µ endpoint'—ã —Å 5xx

---

## Request ID –¥–ª—è —Ç—Ä–µ–π—Å–∏–Ω–≥–∞

### –ó–∞—á–µ–º –Ω—É–∂–µ–Ω Request ID?

**Request ID** ‚Äî —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∑–∞–ø—Ä–æ—Å–∞, –∫–æ—Ç–æ—Ä—ã–π:
- ‚úÖ –ü–æ–º–æ–≥–∞–µ—Ç **–Ω–∞–π—Ç–∏** –ª–æ–≥–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞
- ‚úÖ –ü–æ–∑–≤–æ–ª—è–µ—Ç **–æ—Ç—Å–ª–µ–¥–∏—Ç—å** –∑–∞–ø—Ä–æ—Å —á–µ—Ä–µ–∑ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã
- ‚úÖ –ö–ª–∏–µ–Ω—Ç –º–æ–∂–µ—Ç **—Å–æ–æ–±—â–∏—Ç—å** –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É –¥–ª—è –¥–µ–±–∞–≥–∞

### –§–æ—Ä–º–∞—Ç

\`\`\`http
HTTP/1.1 500 Internal Server Error
X-Request-ID: req-abc123-def456-ghi789
Content-Type: application/json

{
  "error": "Internal Server Error",
  "message": "An unexpected error occurred",
  "requestId": "req-abc123-def456-ghi789"
}
\`\`\`

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è

\`\`\`javascript
// –í middleware
const requestId = \`req-\${Date.now()}-\${Math.random().toString(36)}\`;
req.id = requestId;
res.setHeader('X-Request-ID', requestId);
\`\`\`

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

**–ö–ª–∏–µ–Ω—Ç —Å–æ–æ–±—â–∞–µ—Ç –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É**:
> "–£ –º–µ–Ω—è –æ—à–∏–±–∫–∞ 500, Request ID: req-abc123-def456-ghi789"

**–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–∞—Ö–æ–¥–∏—Ç –ª–æ–≥–∏**:
\`\`\`bash
grep "req-abc123-def456-ghi789" /var/log/api.log
\`\`\`

---

## –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –∫–æ–¥–æ–≤ 5xx

| –ö–æ–¥ | –ù–∞–∑–≤–∞–Ω–∏–µ | –ó–Ω–∞—á–µ–Ω–∏–µ | –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å |
|-----|----------|----------|-------------------|
| **500** | Internal Server Error | –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ | –ù–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ, –æ—à–∏–±–∫–∞ –ë–î |
| **501** | Not Implemented | –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ | HTTP –º–µ—Ç–æ–¥ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è —Å–µ—Ä–≤–µ—Ä–æ–º |
| **502** | Bad Gateway | –û—à–∏–±–∫–∞ —à–ª—é–∑–∞ | –ü—Ä–æ–∫—Å–∏ –ø–æ–ª—É—á–∏–ª –Ω–µ–≤–µ—Ä–Ω—ã–π –æ—Ç–≤–µ—Ç –æ—Ç backend |
| **503** | Service Unavailable | –°–µ—Ä–≤–∏—Å –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω | –û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ, –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∞ (+ Retry-After) |
| **504** | Gateway Timeout | –¢–∞–π–º–∞—É—Ç —à–ª—é–∑–∞ | Backend –Ω–µ –æ—Ç–≤–µ—Ç–∏–ª –≤–æ–≤—Ä–µ–º—è |
| **505** | HTTP Version Not Supported | –í–µ—Ä—Å–∏—è HTTP –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è | –ö–ª–∏–µ–Ω—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—É—é –≤–µ—Ä—Å–∏—é |
| **507** | Insufficient Storage | –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–µ—Å—Ç–∞ | –î–∏—Å–∫ –∑–∞–ø–æ–ª–Ω–µ–Ω, –∫–≤–æ—Ç–∞ –∏—Å—á–µ—Ä–ø–∞–Ω–∞ |
| **511** | Network Authentication Required | –¢—Ä–µ–±—É–µ—Ç—Å—è —Å–µ—Ç–µ–≤–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è | Captive portal (Wi-Fi) |

---

## –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ù–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–∞—è –æ—à–∏–±–∫–∞ –≤ –∫–æ–¥–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

**–°–∏—Ç—É–∞—Ü–∏—è**: –ü—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ GET –∑–∞–ø—Ä–æ—Å–∞ –∫ \`/api/users\` –ø—Ä–æ–∏–∑–æ—à–ª–æ –Ω–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ ‚Äî –ø–æ–ø—ã—Ç–∫–∞ –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –∫ —Å–≤–æ–π—Å—Ç–≤—É –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –æ–±—ä–µ–∫—Ç–∞.

**–ß—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–µ—Ä–≤–µ—Ä**:

\`\`\`http
HTTP/1.1 500 Internal Server Error
Content-Type: application/json

{
  "error": "Internal Server Error",
  "message": "An unexpected error occurred",
  "requestId": "req-abc123"
}
\`\`\`

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ**: –ö–æ–≥–¥–∞ –≤ —Å–µ—Ä–≤–µ—Ä–Ω–æ–º –∫–æ–¥–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –Ω–µ–ø—Ä–µ–¥–≤–∏–¥–µ–Ω–Ω–∞—è –æ—à–∏–±–∫–∞ (exception), –∫–æ—Ç–æ—Ä–∞—è –Ω–µ –±—ã–ª–∞ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–∞, —Å–µ—Ä–≤–µ—Ä –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç **500**. –≠—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç –∫–ª–∏–µ–Ω—Ç—É: "–í–∞—à –∑–∞–ø—Ä–æ—Å –±—ã–ª –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º, –Ω–æ —É –º–µ–Ω—è –ø—Ä–æ–∏–∑–æ—à–ª–∞ –≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –ø—Ä–æ–±–ª–µ–º–∞". –ö–ª–∏–µ–Ω—Ç –º–æ–∂–µ—Ç –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –∑–∞–ø—Ä–æ—Å –ø–æ–∑–∂–µ.

> üí° **–í–∞–∂–Ω–æ –ø–æ–º–Ω–∏—Ç—å**: –í production –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–π—Ç–µ –∫–ª–∏–µ–Ω—Ç—É stack trace –∏–ª–∏ –¥–µ—Ç–∞–ª–∏ –æ—à–∏–±–∫–∏ ‚Äî —ç—Ç–æ —Ä–∏—Å–∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏. –ù–æ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ª–æ–≥–∏—Ä—É–π—Ç–µ –ø–æ–ª–Ω—ã–µ –¥–µ—Ç–∞–ª–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏.

---

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ü–ª–∞–Ω–æ–≤—ã–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ä–∞–±–æ—Ç—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

**–°–∏—Ç—É–∞—Ü–∏—è**: –í—ã –ø—Ä–æ–≤–æ–¥–∏—Ç–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö. –ù–∞ –≤—Ä–µ–º—è –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è (–ø—Ä–∏–º–µ—Ä–Ω–æ 1 —á–∞—Å) API –¥–æ–ª–∂–µ–Ω —Å–æ–æ–±—â–∞—Ç—å –∫–ª–∏–µ–Ω—Ç–∞–º, —á—Ç–æ –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω.

**–ß—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–µ—Ä–≤–µ—Ä**:

\`\`\`http
HTTP/1.1 503 Service Unavailable
Retry-After: 3600
Content-Type: application/json

{
  "error": "Service Unavailable",
  "message": "System is under maintenance",
  "estimatedDowntime": "1 hour"
}
\`\`\`

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ**: –ö–æ–¥ **503** —Å–æ–æ–±—â–∞–µ—Ç, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ –º–æ–∂–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã (–æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ, –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∞). –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∑–∞–≥–æ–ª–æ–≤–æ–∫ **Retry-After**, –∫–æ—Ç–æ—Ä—ã–π —É–∫–∞–∑—ã–≤–∞–µ—Ç –∫–ª–∏–µ–Ω—Ç—É, –∫–æ–≥–¥–∞ –º–æ–∂–Ω–æ –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –∑–∞–ø—Ä–æ—Å. –ó–Ω–∞—á–µ–Ω–∏–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤ —Å–µ–∫—É–Ω–¥–∞—Ö (3600 = 1 —á–∞—Å) –∏–ª–∏ –¥–∞—Ç–æ–π.

> üí° **–í–∞–∂–Ω–æ –ø–æ–º–Ω–∏—Ç—å**: 503 –æ–∑–Ω–∞—á–∞–µ—Ç **–≤—Ä–µ–º–µ–Ω–Ω—É—é** –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å. –ö–ª–∏–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –ø–æ–∑–∂–µ, –∞ –Ω–µ —Å—á–∏—Ç–∞—Ç—å —ç—Ç–æ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π –æ—à–∏–±–∫–æ–π.

---

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: Nginx –Ω–µ –º–æ–∂–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –æ—Ç–≤–µ—Ç –æ—Ç backend –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

**–°–∏—Ç—É–∞—Ü–∏—è**: –£ –≤–∞—Å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å Nginx –∫–∞–∫ reverse proxy –ø–µ—Ä–µ–¥ Node.js backend. –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å, Nginx –ø—Ä–æ–∫—Å–∏—Ä—É–µ—Ç –µ–≥–æ –Ω–∞ backend, –Ω–æ backend –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç corrupted HTTP –æ—Ç–≤–µ—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏).

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**:
\`\`\`
–ö–ª–∏–µ–Ω—Ç ‚Üí Nginx ‚Üí Node.js Backend (–≤–µ—Ä–Ω—É–ª –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π –æ—Ç–≤–µ—Ç)
          ‚Üì
      502 Bad Gateway
\`\`\`

**–ß—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç Nginx –∫–ª–∏–µ–Ω—Ç—É**:

\`\`\`http
HTTP/1.1 502 Bad Gateway
Content-Type: application/json

{
  "error": "Bad Gateway",
  "message": "Upstream server returned an invalid response"
}
\`\`\`

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ**: –ö–æ–¥ **502** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–º–∏ —Å–µ—Ä–≤–µ—Ä–∞–º–∏ (proxy, gateway), –∫–æ–≥–¥–∞ –æ–Ω–∏ **–ø–æ–ª—É—á–∞—é—Ç –Ω–µ–≤–µ—Ä–Ω—ã–π –æ—Ç–≤–µ—Ç** –æ—Ç upstream —Å–µ—Ä–≤–µ—Ä–∞. –≠—Ç–æ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç 503 (—Å–µ—Ä–≤–µ—Ä –≤–æ–æ–±—â–µ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω) –∏ 504 (–Ω–µ –ø–æ–ª—É—á–∏–ª–∏ –æ—Ç–≤–µ—Ç –≤–æ–≤—Ä–µ–º—è).

> üí° **–í–∞–∂–Ω–æ –ø–æ–º–Ω–∏—Ç—å**: 502 = –ø–æ–ª—É—á–∏–ª–∏ –æ—Ç–≤–µ—Ç, –Ω–æ –æ–Ω –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π (corrupted –¥–∞–Ω–Ω—ã–µ, –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏).

---

### –°—Ü–µ–Ω–∞—Ä–∏–π 4: –ú–µ–¥–ª–µ–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–µ–≤—ã—Å–∏–ª —Ç–∞–π–º–∞—É—Ç

**–°–∏—Ç—É–∞—Ü–∏—è**: –ö–ª–∏–µ–Ω—Ç –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏—é —Å–ª–æ–∂–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞ —á–µ—Ä–µ–∑ \`GET /api/reports/generate\`. Nginx –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Å —Ç–∞–π–º–∞—É—Ç–æ–º 60 —Å–µ–∫—É–Ω–¥. Backend –Ω–∞—á–∏–Ω–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É, –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ç—è–∂—ë–ª—ã–π –∑–∞–ø—Ä–æ—Å –∫ –ë–î, –Ω–æ –Ω–µ —É—Å–ø–µ–≤–∞–µ—Ç –æ—Ç–≤–µ—Ç–∏—Ç—å –∑–∞ 60 —Å–µ–∫—É–Ω–¥.

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**:
\`\`\`
–ö–ª–∏–µ–Ω—Ç ‚Üí Nginx (60s timeout) ‚Üí Backend (–æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç 90s...)
          ‚Üì
      504 Gateway Timeout
       (Backend –Ω–µ –æ—Ç–≤–µ—Ç–∏–ª)
\`\`\`

**–ß—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç Nginx —á–µ—Ä–µ–∑ 60 —Å–µ–∫—É–Ω–¥**:

\`\`\`http
HTTP/1.1 504 Gateway Timeout
Content-Type: application/json

{
  "error": "Gateway Timeout",
  "message": "Upstream server did not respond in time",
  "suggestion": "Try reducing the date range or use async processing"
}
\`\`\`

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ**: –ö–æ–¥ **504** –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π —Å–µ—Ä–≤–µ—Ä (proxy) **–Ω–µ –ø–æ–ª—É—á–∏–ª –æ—Ç–≤–µ—Ç** –æ—Ç upstream —Å–µ—Ä–≤–µ—Ä–∞ –≤ —Ç–µ—á–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏. Backend –µ—â—ë –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å, –Ω–æ —Å–ª–∏—à–∫–æ–º –º–µ–¥–ª–µ–Ω–Ω–æ.

**–ö–∞–∫ —Ä–∞–∑–ª–∏—á–∏—Ç—å 502 –∏ 504**:
- **502**: –ü–æ–ª—É—á–∏–ª–∏ –æ—Ç–≤–µ—Ç, –Ω–æ –æ–Ω –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π
- **504**: –ù–µ –ø–æ–ª—É—á–∏–ª–∏ –æ—Ç–≤–µ—Ç –≤–æ–æ–±—â–µ (—Ç–∞–π–º–∞—É—Ç)

> üí° **–í–∞–∂–Ω–æ –ø–æ–º–Ω–∏—Ç—å**: –ü—Ä–∏ 504 –º–æ–∂–Ω–æ –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –∫–ª–∏–µ–Ω—Ç—É –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—É ‚Äî –Ω–∞–ø—Ä–∏–º–µ—Ä, –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –∑–∞–ø—Ä–æ—Å–∞.

---

### –°—Ü–µ–Ω–∞—Ä–∏–π 5: –ü–æ–ø—ã—Ç–∫–∞ –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª –Ω–∞ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–Ω—ã–π –¥–∏—Å–∫

**–°–∏—Ç—É–∞—Ü–∏—è**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—ã—Ç–∞–µ—Ç—Å—è –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —á–µ—Ä–µ–∑ \`POST /api/upload\`, –Ω–æ –¥–∏—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω –Ω–∞ 99%.

**–ß—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–µ—Ä–≤–µ—Ä**:

\`\`\`http
HTTP/1.1 507 Insufficient Storage
Content-Type: application/json

{
  "error": "Insufficient Storage",
  "message": "Server is out of disk space",
  "suggestion": "Please contact support or try again later"
}
\`\`\`

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ**: –ö–æ–¥ **507** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ–≥–¥–∞ —Å–µ—Ä–≤–µ—Ä —Ñ–∏–∑–∏—á–µ—Å–∫–∏ –Ω–µ –º–æ–∂–µ—Ç —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ—Å—É—Ä—Å –∏–∑-–∑–∞ –Ω–µ—Ö–≤–∞—Ç–∫–∏ –º–µ—Å—Ç–∞ –Ω–∞ –¥–∏—Å–∫–µ –∏–ª–∏ –∏—Å—á–µ—Ä–ø–∞–Ω–Ω–æ–π –∫–≤–æ—Ç—ã –ë–î. –≠—Ç–æ —Ä–µ–¥–∫–∏–π –∫–æ–¥, –Ω–æ –≤–∞–∂–Ω—ã–π –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–π —Å —Ñ–∞–π–ª–∞–º–∏ –∏–ª–∏ –±–æ–ª—å—à–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏.

> üí° **–í–∞–∂–Ω–æ –ø–æ–º–Ω–∏—Ç—å**: 507 —Å–æ–æ–±—â–∞–µ—Ç –æ –ø—Ä–æ–±–ª–µ–º–µ —Å —Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º, –∞ –Ω–µ –æ –ø—Ä–æ–±–ª–µ–º–µ —Å –∑–∞–ø—Ä–æ—Å–æ–º –∫–ª–∏–µ–Ω—Ç–∞.

---

### –°—Ü–µ–Ω–∞—Ä–∏–π 6: –†–∞–∑–ª–∏—á–∏–µ –º–µ–∂–¥—É –ø—Ä–æ–±–ª–µ–º–∞–º–∏ —à–ª—é–∑–∞

**–°–∏—Ç—É–∞—Ü–∏—è**: –£ –≤–∞—Å –µ—Å—Ç—å —Ç—Ä–∏ —Ä–∞–∑–Ω—ã–µ —Å–∏—Ç—É–∞—Ü–∏–∏ —Å –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä–æ–º. –ö–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤—ã–±—Ä–∞—Ç—å –∫–æ–¥?

**–°–∏—Ç—É–∞—Ü–∏—è –ê**: Backend –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç —É–∂–µ 2 –º–∏–Ω—É—Ç—ã (–Ω–∞—Å—Ç—Ä–æ–µ–Ω —Ç–∞–π–º–∞—É—Ç 60 —Å–µ–∫—É–Ω–¥).
‚Üí **–û—Ç–≤–µ—Ç: 504 Gateway Timeout** (–Ω–µ –ø–æ–ª—É—á–∏–ª–∏ –æ—Ç–≤–µ—Ç –≤–æ–≤—Ä–µ–º—è)

**–°–∏—Ç—É–∞—Ü–∏—è –ë**: Backend –≤–µ—Ä–Ω—É–ª HTTP –æ—Ç–≤–µ—Ç —Å –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–º–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏.
‚Üí **–û—Ç–≤–µ—Ç: 502 Bad Gateway** (–ø–æ–ª—É—á–∏–ª–∏ –Ω–µ–≤–µ—Ä–Ω—ã–π –æ—Ç–≤–µ—Ç)

**–°–∏—Ç—É–∞—Ü–∏—è –í**: –°–µ—Ä–≤–µ—Ä –ø—Ä–æ–≤–æ–¥–∏—Ç –ø–ª–∞–Ω–æ–≤–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ –ë–î.
‚Üí **–û—Ç–≤–µ—Ç: 503 Service Unavailable + Retry-After** (–≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω)

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ**: –≠—Ç–∏ —Ç—Ä–∏ –∫–æ–¥–∞ —á–∞—Å—Ç–æ –ø—É—Ç–∞—é—Ç, –Ω–æ –æ–Ω–∏ –æ–ø–∏—Å—ã–≤–∞—é—Ç —Ä–∞–∑–Ω—ã–µ —Å–∏—Ç—É–∞—Ü–∏–∏:
- **502** = –ø—Ä–æ–±–ª–µ–º–∞ —Å **–∫–∞—á–µ—Å—Ç–≤–æ–º** –æ—Ç–≤–µ—Ç–∞ (–ø–æ–ª—É—á–∏–ª–∏ –º—É—Å–æ—Ä)
- **503** = –ø—Ä–æ–±–ª–µ–º–∞ —Å **–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å—é** (–≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç)
- **504** = –ø—Ä–æ–±–ª–µ–º–∞ —Å–æ **—Å–∫–æ—Ä–æ—Å—Ç—å—é** –æ—Ç–≤–µ—Ç–∞ (—Ç–∞–π–º–∞—É—Ç)

> üí° **–í–∞–∂–Ω–æ –ø–æ–º–Ω–∏—Ç—å**: –ï—Å–ª–∏ –µ—Å—Ç—å –ø—Ä–æ–∫—Å–∏/gateway –∏ –æ–Ω —É—á–∞—Å—Ç–≤—É–µ—Ç –≤ –æ—à–∏–±–∫–µ ‚Üí –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ 502/504. –ï—Å–ª–∏ –ø—Ä–æ—Å—Ç–æ –≤—Ä–µ–º–µ–Ω–Ω–∞—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å ‚Üí 503.

---

### –°—Ü–µ–Ω–∞—Ä–∏–π 7: –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–Ω—ã—Ö –æ—à–∏–±–æ–∫

**–°–∏—Ç—É–∞—Ü–∏—è**: –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î. –ß—Ç–æ –º–æ–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å –∫–ª–∏–µ–Ω—Ç—É, –∞ —á—Ç–æ —Ç–æ–ª—å–∫–æ –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å?

**–ß—Ç–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –∫–ª–∏–µ–Ω—Ç—É** (–±–µ–∑–æ–ø–∞—Å–Ω–æ):

\`\`\`http
HTTP/1.1 500 Internal Server Error
X-Request-ID: req-abc123
Content-Type: application/json

{
  "error": "Internal Server Error",
  "message": "An unexpected error occurred",
  "requestId": "req-abc123"
}
\`\`\`

**–ß—Ç–æ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ** (–ø–æ–ª–Ω—ã–µ –¥–µ—Ç–∞–ª–∏):

\`\`\`javascript
{
  "level": "ERROR",
  "requestId": "req-abc123",
  "error": "Connection timeout to PostgreSQL",
  "stack": "Error: connect ETIMEDOUT 10.0.1.42:5432...",
  "query": "SELECT * FROM users WHERE id = $1",
  "userId": "user-456",
  "timestamp": "2024-01-15T10:30:00Z"
}
\`\`\`

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ**: –í—Å–µ –æ—à–∏–±–∫–∏ —Å–µ—Ä–≤–µ—Ä–Ω–æ–π —Å—Ç–æ—Ä–æ–Ω—ã (5xx) **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è** —Å –ø–æ–ª–Ω—ã–º–∏ –¥–µ—Ç–∞–ª—è–º–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏. –ù–æ –∫–ª–∏–µ–Ω—Ç—É –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–±—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ **Request ID** ‚Äî —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∑–∞–ø—Ä–æ—Å–∞, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ç–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–µ –Ω–∞–π—Ç–∏ –ª–æ–≥–∏.

**–ù–ò–ö–û–ì–î–ê –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–π—Ç–µ –∫–ª–∏–µ–Ω—Ç—É**:
- Stack traces (—Ä–∞—Å–∫—Ä—ã–≤–∞—é—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–æ–¥–∞)
- SQL –∑–∞–ø—Ä–æ—Å—ã (—Ä–∏—Å–∫ SQL injection)
- –ü—É—Ç–∏ –∫ —Ñ–∞–π–ª–∞–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- –î–µ—Ç–∞–ª–∏ –ë–î –æ—à–∏–±–æ–∫

> üí° **–í–∞–∂–Ω–æ –ø–æ–º–Ω–∏—Ç—å**: Request ID ‚Äî —ç—Ç–æ –º–æ—Å—Ç –º–µ–∂–¥—É –∫–ª–∏–µ–Ω—Ç–æ–º –∏ –ª–æ–≥–∞–º–∏ —Å–µ—Ä–≤–µ—Ä–∞. –ö–ª–∏–µ–Ω—Ç —Å–æ–æ–±—â–∞–µ—Ç "–æ—à–∏–±–∫–∞ —Å ID req-abc123", –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–∞—Ö–æ–¥–∏—Ç –ª–æ–≥–∏ –ø–æ —ç—Ç–æ–º—É ID.

---

### –°—Ü–µ–Ω–∞—Ä–∏–π 8: –ù–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π HTTP –º–µ—Ç–æ–¥ –Ω–∞ —É—Ä–æ–≤–Ω–µ —Å–µ—Ä–≤–µ—Ä–∞

**–°–∏—Ç—É–∞—Ü–∏—è**: –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å —Å –º–µ—Ç–æ–¥–æ–º \`TRACE\`, –Ω–æ –≤–∞—à —Å–µ—Ä–≤–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —ç—Ç–æ—Ç –º–µ—Ç–æ–¥ –≤–æ–æ–±—â–µ (–æ–Ω –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –Ω–∞ —É—Ä–æ–≤–Ω–µ —Å–µ—Ä–≤–µ—Ä–∞).

**–ß—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–µ—Ä–≤–µ—Ä**:

\`\`\`http
HTTP/1.1 501 Not Implemented
Content-Type: application/json

{
  "error": "Not Implemented",
  "message": "TRACE method is not supported by this server",
  "supportedMethods": ["GET", "POST", "PUT", "PATCH", "DELETE"]
}
\`\`\`

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ**: –ö–æ–¥ **501** –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä **–≤–æ–æ–±—â–µ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç** —Ç—Ä–µ–±—É–µ–º—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å. –≠—Ç–æ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç 405 (Method Not Allowed), –∫–æ—Ç–æ—Ä—ã–π –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –º–µ—Ç–æ–¥ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –Ω–æ –Ω–µ —Ä–∞–∑—Ä–µ—à—ë–Ω –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ endpoint.

**–°—Ä–∞–≤–Ω–µ–Ω–∏–µ**:
- **501**: –°–µ—Ä–≤–µ—Ä –Ω–µ –∑–Ω–∞–µ—Ç, —á—Ç–æ —Ç–∞–∫–æ–µ TRACE ‚Üí "–Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≥–ª–æ–±–∞–ª—å–Ω–æ"
- **405**: –ú–µ—Ç–æ–¥ POST —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –Ω–æ –Ω–µ –Ω–∞ \`/users/123\` ‚Üí "–Ω–µ —Ä–∞–∑—Ä–µ—à—ë–Ω –∑–¥–µ—Å—å"

> üí° **–í–∞–∂–Ω–æ –ø–æ–º–Ω–∏—Ç—å**: 501 –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ä–µ–¥–∫–æ, –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –¥–ª—è —ç–∫–∑–æ—Ç–∏—á–µ—Å–∫–∏—Ö HTTP –º–µ—Ç–æ–¥–æ–≤ –∏–ª–∏ features, –∫–æ—Ç–æ—Ä—ã–µ —Å–µ—Ä–≤–µ—Ä –ø—Ä–∏–Ω—Ü–∏–ø–∏–∞–ª—å–Ω–æ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç.

---

### –°—Ü–µ–Ω–∞—Ä–∏–π 9: –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ vs —Å–µ—Ä–≤–µ—Ä–Ω–∞—è –æ—à–∏–±–∫–∞

**–°–∏—Ç—É–∞—Ü–∏—è**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—ã—Ç–∞–µ—Ç—Å—è —Å–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç —Å email, –∫–æ—Ç–æ—Ä—ã–π —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ —Å–∏—Å—Ç–µ–º–µ. –ö–∞–∫–æ–π –∫–æ–¥ –≤–µ—Ä–Ω—É—Ç—å?

‚ùå **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ**:

\`\`\`http
HTTP/1.1 500 Internal Server Error
{"error": "User already exists"}
\`\`\`

‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–æ**:

\`\`\`http
HTTP/1.1 409 Conflict
{"error": "User with this email already exists"}
\`\`\`

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ**: –ö–æ–¥ **500** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è **—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö —Å–µ—Ä–≤–µ—Ä–Ω—ã—Ö –æ—à–∏–±–æ–∫** (exception, –æ—à–∏–±–∫–∞ –ë–î, —Å–±–æ–π —Å–∏—Å—Ç–µ–º—ã). –ï—Å–ª–∏ —ç—Ç–æ **–±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–æ** (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤, –Ω–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö) ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–¥—ã **4xx** (400, 409, 422, 403).

**–ü—Ä–∞–≤–∏–ª–æ**: –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ –≤–æ–∑–Ω–∏–∫–ª–∞ –∏–∑-–∑–∞ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏, –∫–æ—Ç–æ—Ä—É—é –º–æ–∂–Ω–æ –ø—Ä–µ–¥–≤–∏–¥–µ—Ç—å ‚Üí —ç—Ç–æ 4xx, –∞ –Ω–µ 5xx.

> üí° **–í–∞–∂–Ω–æ –ø–æ–º–Ω–∏—Ç—å**: 5xx = "—á—Ç–æ-—Ç–æ —Å–ª–æ–º–∞–ª–æ—Å—å –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω–æ", 4xx = "—ç—Ç–æ –æ–∂–∏–¥–∞–µ–º–∞—è —Å–∏—Ç—É–∞—Ü–∏—è, –∏—Å–ø—Ä–∞–≤—å—Ç–µ –∑–∞–ø—Ä–æ—Å".

---

### –°—Ü–µ–Ω–∞—Ä–∏–π 10: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª–µ–∑–Ω—ã—Ö –ø–æ–¥—Å–∫–∞–∑–æ–∫ –≤ –æ—Ç–≤–µ—Ç—ã 5xx

**–°–∏—Ç—É–∞—Ü–∏—è**: –ü—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç—á—ë—Ç–∞ –∑–∞ –≥–æ–¥ –ø—Ä–æ–∏–∑–æ—à—ë–ª —Ç–∞–π–º–∞—É—Ç (504). –ö–∞–∫ —Å–¥–µ–ª–∞—Ç—å –æ—Ç–≤–µ—Ç –±–æ–ª–µ–µ –ø–æ–ª–µ–∑–Ω—ã–º –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞?

‚ùå **–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç**:

\`\`\`http
HTTP/1.1 504 Gateway Timeout
{"error": "Timeout"}
\`\`\`

‚úÖ **–ü–æ–ª–µ–∑–Ω—ã–π –æ—Ç–≤–µ—Ç**:

\`\`\`http
HTTP/1.1 504 Gateway Timeout
Content-Type: application/json

{
  "error": "Gateway Timeout",
  "message": "Report generation took too long",
  "suggestion": "Try reducing the date range to 6 months or less",
  "alternativeSolution": "Use POST /api/reports/async for large reports",
  "requestId": "req-xyz123",
  "supportContact": "support@example.com"
}
\`\`\`

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ**: –î–∞–∂–µ –ø—Ä–∏ —Å–µ—Ä–≤–µ—Ä–Ω—ã—Ö –æ—à–∏–±–∫–∞—Ö –º–æ–∂–Ω–æ –ø–æ–º–æ—á—å –∫–ª–∏–µ–Ω—Ç—É —Ä–µ—à–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É. –í–∫–ª—é—á–∏—Ç–µ:
- –ü–æ–Ω—è—Ç–Ω–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ —á—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ
- –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –∫–∞–∫ –∏–∑–±–µ–∂–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã
- –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π API)
- Request ID –¥–ª—è –æ–±—Ä–∞—â–µ–Ω–∏—è –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É
- –ö–æ–Ω—Ç–∞–∫—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏

> üí° **–í–∞–∂–Ω–æ –ø–æ–º–Ω–∏—Ç—å**: –•–æ—Ä–æ—à–∏–π API –ø–æ–º–æ–≥–∞–µ—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞–º –¥–∞–∂–µ –∫–æ–≥–¥–∞ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫.

---

## Best Practices ‚Äî –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

### 1. –ù–ï –≤–æ–∑–≤—Ä–∞—â–∞–π—Ç–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

‚ùå **–ù–ò–ö–û–ì–î–ê**:
\`\`\`json
{
  "error": "Database error",
  "details": "SELECT * FROM users WHERE password = 'admin123' failed",
  "stack": "Error: Connection failed\\n    at /home/user/app/db.js:45..."
}
\`\`\`

‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–æ**:
\`\`\`json
{
  "error": "Internal Server Error",
  "message": "An unexpected error occurred",
  "requestId": "req-abc123"
}
\`\`\`

### 2. –í–°–ï–ì–î–ê –ª–æ–≥–∏—Ä—É–π—Ç–µ –ø–æ–ª–Ω—ã–µ –¥–µ—Ç–∞–ª–∏

‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–æ**:
\`\`\`javascript
logger.error({
  requestId: req.id,
  error: error.message,
  stack: error.stack,
  url: req.url,
  method: req.method,
  userId: req.user?.id
});
\`\`\`

### 3. –î–æ–±–∞–≤–ª—è–π—Ç–µ Request ID

‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–æ**:
\`\`\`http
HTTP/1.1 500 Internal Server Error
X-Request-ID: req-abc123
Content-Type: application/json

{
  "error": "Internal Server Error",
  "requestId": "req-abc123"
}
\`\`\`

### 4. –î–æ–±–∞–≤–ª—è–π—Ç–µ Retry-After –∫ 503

‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–æ**:
\`\`\`http
HTTP/1.1 503 Service Unavailable
Retry-After: 60
Content-Type: application/json

{
  "error": "Service Unavailable",
  "retryAfter": 60
}
\`\`\`

### 5. –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ 500 –¥–ª—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏

‚ùå **–ü–ª–æ—Ö–æ**:
\`\`\`http
HTTP/1.1 500 Internal Server Error
{"error": "User already exists"}  ‚Üê –î–æ–ª–∂–Ω–æ –±—ã—Ç—å 409!
\`\`\`

‚úÖ **–•–æ—Ä–æ—à–æ**:
\`\`\`http
HTTP/1.1 409 Conflict
{"error": "User already exists"}
\`\`\`

### 6. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ 5xx

‚úÖ **–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ**:
- –ê–ª–µ—Ä—Ç—ã –ø—Ä–∏ —Ä–æ—Å—Ç–µ 5xx
- Dashboard —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏
- Rate of 5xx errors
- –¢–æ–ø endpoint'–æ–≤ —Å –æ—à–∏–±–∫–∞–º–∏

### 7. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∫–æ–¥ –¥–ª—è –∫–∞–∂–¥–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏

| –°–∏—Ç—É–∞—Ü–∏—è | –ö–æ–¥ |
|----------|-----|
| –ù–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ | 500 |
| –û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ, –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∞ | 503 |
| Backend –Ω–µ –æ—Ç–≤–µ—Ç–∏–ª | 504 |
| Backend –≤–µ—Ä–Ω—É–ª –º—É—Å–æ—Ä | 502 |
| –î–∏—Å–∫ –∑–∞–ø–æ–ª–Ω–µ–Ω | 507 |

### 8. –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–π—Ç–µ –ø–æ–º–æ—â—å –∫–ª–∏–µ–Ω—Ç—É

‚úÖ **–•–æ—Ä–æ—à–æ**:
\`\`\`json
{
  "error": "Gateway Timeout",
  "message": "Request took too long",
  "suggestion": "Try reducing the date range",
  "supportContact": "support@example.com",
  "requestId": "req-abc123"
}
\`\`\`

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**HTTP —Å—Ç–∞—Ç—É—Å –∫–æ–¥—ã 5xx** ‚Äî —ç—Ç–æ —Å–ø–æ—Å–æ–± —Å–µ—Ä–≤–µ—Ä–∞ —Å–æ–æ–±—â–∏—Ç—å:
> "–ü—Ä–æ–±–ª–µ–º–∞ –Ω–∞ **–º–æ–µ–π** —Å—Ç–æ—Ä–æ–Ω–µ. –í–∞—à –∑–∞–ø—Ä–æ—Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ."

**–ó–∞–ø–æ–º–Ω–∏—Ç–µ –≥–ª–∞–≤–Ω–æ–µ**:

1. **500 Internal Server Error** ‚Äî –æ–±—â–∞—è —Å–µ—Ä–≤–µ—Ä–Ω–∞—è –æ—à–∏–±–∫–∞ (–∏—Å–∫–ª—é—á–µ–Ω–∏–µ, –æ—à–∏–±–∫–∞ –ë–î)
2. **502 Bad Gateway** ‚Äî –ø—Ä–æ–∫—Å–∏ –ø–æ–ª—É—á–∏–ª –Ω–µ–≤–µ—Ä–Ω—ã–π –æ—Ç–≤–µ—Ç –æ—Ç backend
3. **503 Service Unavailable** ‚Äî –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω (–æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ, –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∞) + Retry-After
4. **504 Gateway Timeout** ‚Äî backend –Ω–µ –æ—Ç–≤–µ—Ç–∏–ª –≤–æ–≤—Ä–µ–º—è (—Ç–∞–π–º–∞—É—Ç)
5. **505 HTTP Version Not Supported** ‚Äî –≤–µ—Ä—Å–∏—è HTTP –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è

**502 vs 503 vs 504**:
- 502 = –ù–µ–≤–µ—Ä–Ω—ã–π –æ—Ç–≤–µ—Ç –æ—Ç backend
- 503 = –í—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω (–æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ)
- 504 = –¢–∞–π–º–∞—É—Ç (–Ω–µ –æ—Ç–≤–µ—Ç–∏–ª –≤–æ–≤—Ä–µ–º—è)

**–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**:
- ‚ùå –ù–ï –≤–æ–∑–≤—Ä–∞—â–∞–π—Ç–µ stack traces, SQL –∑–∞–ø—Ä–æ—Å—ã, –ø—É—Ç–∏ –∫ —Ñ–∞–π–ª–∞–º
- ‚úÖ –í–æ–∑–≤—Ä–∞—â–∞–π—Ç–µ –æ–±—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ + Request ID
- ‚úÖ –õ–æ–≥–∏—Ä—É–π—Ç–µ –í–°–ï –¥–µ—Ç–∞–ª–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

**–î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤**:
- ‚úÖ –í–°–ï–ì–î–ê –ª–æ–≥–∏—Ä—É–π—Ç–µ 5xx —Å –ø–æ–ª–Ω—ã–º–∏ –¥–µ—Ç–∞–ª—è–º–∏
- ‚úÖ –î–æ–±–∞–≤–ª—è–π—Ç–µ Request ID –¥–ª—è —Ç—Ä–µ–π—Å–∏–Ω–≥–∞
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–ª–µ—Ä—Ç—ã
- ‚ùå –ù–ï –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ 500 –¥–ª—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏ (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ 4xx)

–ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–¥–æ–≤ 5xx –ø–æ–º–æ–≥–∞–µ—Ç **–±—ã—Å—Ç—Ä–æ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å** –ø—Ä–æ–±–ª–µ–º—ã –∏ **—É–ª—É—á—à–∞—Ç—å** –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç—å –≤–∞—à–µ–≥–æ API!
`;

async function createLecture() {
  try {
    console.log('üéì –°–æ–∑–¥–∞–Ω–∏–µ –ª–µ–∫—Ü–∏–∏ –ø–æ —Å—Ç–∞—Ç—É—Å –∫–æ–¥–∞–º 5xx...\n');

    const test = await prisma.test.findFirst({
      where: {
        title: '–°—Ç–∞—Ç—É—Å –∫–æ–¥—ã: –æ—à–∏–±–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞',
      },
      include: {
        questions: {
          include: {
            question: true,
          },
          orderBy: {
            order: 'asc',
          },
        },
      },
    });

    if (!test) {
      console.error('‚ùå –¢–µ—Å—Ç "–°—Ç–∞—Ç—É—Å –∫–æ–¥—ã: –æ—à–∏–±–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞" –Ω–µ –Ω–∞–π–¥–µ–Ω!');
      return;
    }

    console.log(`‚úÖ –ù–∞–π–¥–µ–Ω —Ç–µ—Å—Ç: ${test.title}`);
    console.log(`üìä –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ–ø—Ä–æ—Å–æ–≤: ${test.questions.length}\n`);

    console.log('üìù –°–æ–∑–¥–∞–Ω–∏–µ –ª–µ–∫—Ü–∏–∏...');
    const lecture = await prisma.lecture.create({
      data: {
        title: 'HTTP –°—Ç–∞—Ç—É—Å –∫–æ–¥—ã: –û—à–∏–±–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞ (5xx)',
        topic: 'HTTP —Å—Ç–∞—Ç—É—Å –∫–æ–¥—ã',
        content: lectureContent,
      },
    });

    console.log(`‚úÖ –õ–µ–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞ —Å ID: ${lecture.id}\n`);

    console.log('üîó –ü—Ä–∏–≤—è–∑–∫–∞ –ª–µ–∫—Ü–∏–∏ –∫ –≤–æ–ø—Ä–æ—Å–∞–º —Ç–µ—Å—Ç–∞...');
    const questionIds = test.questions.map((tq) => tq.questionId);

    let linkedCount = 0;
    for (const questionId of questionIds) {
      await prisma.question.update({
        where: { id: questionId },
        data: { lectureId: lecture.id },
      });
      linkedCount++;
    }

    console.log(`‚úÖ –õ–µ–∫—Ü–∏—è –ø—Ä–∏–≤—è–∑–∞–Ω–∞ –∫ ${linkedCount} –≤–æ–ø—Ä–æ—Å–∞–º\n`);

    console.log('üéâ –ì–æ—Ç–æ–≤–æ!');
    console.log(`\nüìö –õ–µ–∫—Ü–∏—è "${lecture.title}" —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–∞ –∏ –ø—Ä–∏–≤—è–∑–∞–Ω–∞ –∫ —Ç–µ—Å—Ç—É "${test.title}"`);
  } catch (error) {
    console.error('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ª–µ–∫—Ü–∏–∏:', error);
    throw error;
  } finally {
    await prisma.$disconnect();
  }
}

createLecture();
